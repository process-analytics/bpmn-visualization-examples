var Vt=Object.defineProperty;var Yt=(n,e,t)=>e in n?Vt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var g=(n,e,t)=>(Yt(n,typeof e!="symbol"?e+"":e,t),t);import{f as Ut}from"./mxgraph.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();var te=(n=>(n.None="None",n.HorizontalVertical="HorizontalVertical",n.Horizontal="Horizontal",n.Vertical="Vertical",n.Center="Center",n))(te||{}),Wt=(n=>(n.In="in",n.Out="out",n))(Wt||{}),d=(n=>(n.LANE="lane",n.POOL="pool",n.CALL_ACTIVITY="callActivity",n.SUB_PROCESS="subProcess",n.TASK="task",n.TASK_USER="userTask",n.TASK_SERVICE="serviceTask",n.TASK_RECEIVE="receiveTask",n.TASK_SEND="sendTask",n.TASK_MANUAL="manualTask",n.TASK_SCRIPT="scriptTask",n.TASK_BUSINESS_RULE="businessRuleTask",n.GLOBAL_TASK="globalTask",n.GLOBAL_TASK_USER="globalUserTask",n.GLOBAL_TASK_MANUAL="globalManualTask",n.GLOBAL_TASK_SCRIPT="globalScriptTask",n.GLOBAL_TASK_BUSINESS_RULE="globalBusinessRuleTask",n.GROUP="group",n.TEXT_ANNOTATION="textAnnotation",n.GATEWAY_PARALLEL="parallelGateway",n.GATEWAY_EXCLUSIVE="exclusiveGateway",n.GATEWAY_INCLUSIVE="inclusiveGateway",n.GATEWAY_EVENT_BASED="eventBasedGateway",n.GATEWAY_COMPLEX="complexGateway",n.EVENT_START="startEvent",n.EVENT_END="endEvent",n.EVENT_INTERMEDIATE_CATCH="intermediateCatchEvent",n.EVENT_INTERMEDIATE_THROW="intermediateThrowEvent",n.EVENT_BOUNDARY="boundaryEvent",n))(d||{}),ne=(n=>(n.CALLING_PROCESS="process",n.CALLING_GLOBAL_TASK="global task",n))(ne||{}),se=(n=>(n.Exclusive="Exclusive",n.None="None",n.Parallel="Parallel",n))(se||{}),_=(n=>(n.NONE="none",n.TERMINATE="terminate",n.CANCEL="cancel",n.COMPENSATION="compensate",n.CONDITIONAL="conditional",n.ERROR="error",n.ESCALATION="escalation",n.LINK="link",n.MESSAGE="message",n.SIGNAL="signal",n.TIMER="timer",n))(_||{}),v=(n=>(n.ADHOC="adhoc",n.COMPENSATION="compensation",n.EXPAND="expand",n.LOOP="loop",n.MULTI_INSTANCE_PARALLEL="parallel multi instance",n.MULTI_INSTANCE_SEQUENTIAL="sequential multi instance",n))(v||{}),he=(n=>(n.EMBEDDED="embedded",n.EVENT="event",n))(he||{});function Ht(n,e){return n===""?e?{}:void 0:n}function C(n,e=!1){return n==null?[]:(Array.isArray(n)?n:[n]).map(t=>Ht(t,e)).filter(Boolean)}function Kt(n,e,t){let s="";return t!=null&&t.startingWith?s=s.concat(`^(${t.startingWith}).*`):t!=null&&t.notStartingWith&&(s=s.concat(`^(?!(${t.notStartingWith})).*`)),s=s.concat(`${e}$`),n.filter(i=>t!=null&&t.ignoreCase?new RegExp(s,"i").test(i):new RegExp(s).test(i))}class S{static isEvent(e){return ce(Xe,e)}static eventKinds(){return[...Xe]}static isBoundaryEvent(e){return d.EVENT_BOUNDARY===e}static isStartEvent(e){return d.EVENT_START===e}static isCallActivity(e){return d.CALL_ACTIVITY===e}static isSubProcess(e){return d.SUB_PROCESS===e}static canHaveNoneEvent(e){return d.EVENT_INTERMEDIATE_THROW===e||d.EVENT_END===e||d.EVENT_START===e}static isActivity(e){return ce(_e,e)}static activityKinds(){return[..._e]}static isWithDefaultSequenceFlow(e){return zt.includes(e)}static isTask(e){return ce(ve,e)}static taskKinds(){return[...ve]}static gatewayKinds(){return[...$e]}static isGateway(e){return ce($e,e)}static flowNodeKinds(){return Object.values(d).filter(e=>!S.isPoolOrLane(e))}static isPoolOrLane(e){return e==d.POOL||e==d.LANE}}function Fe(n,e){return Kt(Object.values(d),n,e)}function ce(n,e){return Object.values(n).map(t=>t).includes(e)}const Xe=Fe("Event"),$e=Fe("Gateway"),ve=Fe("Task",{ignoreCase:!0,notStartingWith:"global"}),_e=[...ve,d.CALL_ACTIVITY,d.SUB_PROCESS],zt=[..._e,d.GATEWAY_EXCLUSIVE,d.GATEWAY_INCLUSIVE,d.GATEWAY_COMPLEX],lt=Object.values(_).filter(n=>n!=_.NONE);var H=(n=>(n.NONE="None",n.ONE="One",n.BOTH="Both",n))(H||{}),b=(n=>(n.SEQUENCE_FLOW="sequenceFlow",n.MESSAGE_FLOW="messageFlow",n.ASSOCIATION_FLOW="association",n))(b||{}),re=(n=>(n.NONE="none",n.INITIATING="initiating",n.NON_INITIATING="non_initiating",n))(re||{}),P=(n=>(n.NORMAL="normal",n.DEFAULT="default",n.CONDITIONAL_FROM_ACTIVITY="conditional_from_activity",n.CONDITIONAL_FROM_GATEWAY="conditional_from_gateway",n))(P||{});const a=Dt();function Dt(){return window.mxForceIncludes=!1,window.mxLoadResources=!1,window.mxLoadStylesheets=!1,window.mxResourceExtension=".txt",Ut({})}class m{}g(m,"EDGE","bpmn.edge"),g(m,"EDGE_START_FILL_COLOR","bpmn.edge.startFillColor"),g(m,"EDGE_END_FILL_COLOR","bpmn.edge.endFillColor"),g(m,"EVENT_BASED_GATEWAY_KIND","bpmn.gatewayKind"),g(m,"EVENT_DEFINITION_KIND","bpmn.eventDefinitionKind"),g(m,"GLOBAL_TASK_KIND","bpmn.globalTaskKind"),g(m,"SUB_PROCESS_KIND","bpmn.subProcessKind"),g(m,"IS_INITIATING","bpmn.isInitiating"),g(m,"IS_INSTANTIATING","bpmn.isInstantiating"),g(m,"IS_INTERRUPTING","bpmn.isInterrupting"),g(m,"EXTRA_CSS_CLASSES","bpmn.extra.css.classes"),g(m,"MARKERS","bpmn.markers"),g(m,"MESSAGE_FLOW_ICON","bpmn.messageFlowIcon");class Pe{}g(Pe,"ARROW_DASH","bpmn.dash");var E=(n=>(n[n.STROKE_WIDTH_THIN=2]="STROKE_WIDTH_THIN",n[n.STROKE_WIDTH_THICK=5]="STROKE_WIDTH_THICK",n[n.SHAPE_ACTIVITY_BOTTOM_MARGIN=7]="SHAPE_ACTIVITY_BOTTOM_MARGIN",n[n.SHAPE_ACTIVITY_TOP_MARGIN=7]="SHAPE_ACTIVITY_TOP_MARGIN",n[n.SHAPE_ACTIVITY_LEFT_MARGIN=7]="SHAPE_ACTIVITY_LEFT_MARGIN",n[n.SHAPE_ACTIVITY_FROM_CENTER_MARGIN=7]="SHAPE_ACTIVITY_FROM_CENTER_MARGIN",n[n.SHAPE_ACTIVITY_MARKER_ICON_MARGIN=5]="SHAPE_ACTIVITY_MARKER_ICON_MARGIN",n[n.SHAPE_ACTIVITY_MARKER_ICON_SIZE=20]="SHAPE_ACTIVITY_MARKER_ICON_SIZE",n[n.POOL_LABEL_SIZE=30]="POOL_LABEL_SIZE",n.POOL_LABEL_FILL_COLOR="none",n[n.LANE_LABEL_SIZE=30]="LANE_LABEL_SIZE",n.LANE_LABEL_FILL_COLOR="none",n[n.TEXT_ANNOTATION_BORDER_LENGTH=10]="TEXT_ANNOTATION_BORDER_LENGTH",n.TEXT_ANNOTATION_FILL_COLOR="none",n.GROUP_FILL_COLOR="none",n.DEFAULT_FILL_COLOR="White",n.DEFAULT_STROKE_COLOR="Black",n.DEFAULT_FONT_FAMILY="Arial, Helvetica, sans-serif",n[n.DEFAULT_FONT_SIZE=11]="DEFAULT_FONT_SIZE",n.DEFAULT_FONT_COLOR="Black",n[n.DEFAULT_MARGIN=0]="DEFAULT_MARGIN",n[n.SHAPE_ARC_SIZE=20]="SHAPE_ARC_SIZE",n.DEFAULT_OVERLAY_FILL_COLOR="White",n[n.DEFAULT_OVERLAY_FILL_OPACITY=100]="DEFAULT_OVERLAY_FILL_OPACITY",n.DEFAULT_OVERLAY_STROKE_COLOR="Black",n[n.DEFAULT_OVERLAY_STROKE_WIDTH=1]="DEFAULT_OVERLAY_STROKE_WIDTH",n[n.DEFAULT_OVERLAY_FONT_SIZE=11]="DEFAULT_OVERLAY_FONT_SIZE",n.DEFAULT_OVERLAY_FONT_COLOR="Black",n.SEQUENCE_FLOW_CONDITIONAL_FROM_ACTIVITY_MARKER_FILL_COLOR="White",n.MESSAGE_FLOW_MARKER_START_FILL_COLOR="White",n.MESSAGE_FLOW_MARKER_END_FILL_COLOR="White",n))(E||{});const ct=n=>a.mxUtils.getValue(n,m.IS_INSTANTIATING,"false")=="true",Ze=12;class ut{constructor(e){g(this,"specificFlowStyles",new Oe([[b.SEQUENCE_FLOW,e=>{e[a.mxConstants.STYLE_ENDARROW]=a.mxConstants.ARROW_BLOCK_THIN}],[b.MESSAGE_FLOW,e=>{e[a.mxConstants.STYLE_DASHED]=!0,e[a.mxConstants.STYLE_DASH_PATTERN]="8 5",e[a.mxConstants.STYLE_STARTARROW]=a.mxConstants.ARROW_OVAL,e[a.mxConstants.STYLE_STARTSIZE]=8,e[a.mxConstants.STYLE_STARTFILL]=!0,e[m.EDGE_START_FILL_COLOR]=E.MESSAGE_FLOW_MARKER_START_FILL_COLOR,e[a.mxConstants.STYLE_ENDARROW]=a.mxConstants.ARROW_BLOCK_THIN,e[a.mxConstants.STYLE_ENDFILL]=!0,e[m.EDGE_END_FILL_COLOR]=E.MESSAGE_FLOW_MARKER_END_FILL_COLOR}],[b.ASSOCIATION_FLOW,e=>{e[a.mxConstants.STYLE_DASHED]=!0,e[a.mxConstants.STYLE_DASH_PATTERN]="1 2",e[a.mxConstants.STYLE_STARTSIZE]=Ze}]]));g(this,"specificSequenceFlowStyles",new Oe([[P.DEFAULT,e=>{e[a.mxConstants.STYLE_STARTARROW]=Pe.ARROW_DASH}],[P.CONDITIONAL_FROM_ACTIVITY,e=>{e[a.mxConstants.STYLE_STARTARROW]=a.mxConstants.ARROW_DIAMOND_THIN,e[a.mxConstants.STYLE_STARTSIZE]=18,e[a.mxConstants.STYLE_STARTFILL]=!0,e[m.EDGE_START_FILL_COLOR]=E.SEQUENCE_FLOW_CONDITIONAL_FROM_ACTIVITY_MARKER_FILL_COLOR}]]));g(this,"specificAssociationFlowStyles",new Oe([[H.NONE,e=>{}],[H.ONE,e=>{e[a.mxConstants.STYLE_ENDARROW]=a.mxConstants.ARROW_OPEN_THIN}],[H.BOTH,e=>{e[a.mxConstants.STYLE_STARTARROW]=a.mxConstants.ARROW_OPEN_THIN,e[a.mxConstants.STYLE_ENDARROW]=a.mxConstants.ARROW_OPEN_THIN}]]));this.graph=e}configureStyles(){this.configureDefaultVertexStyle(),this.configurePoolStyle(),this.configureLaneStyle(),this.configureTextAnnotationStyle(),this.configureGroupStyle(),this.configureActivityStyles(),this.configureEventStyles(),this.configureGatewayStyles(),this.configureDefaultEdgeStyle(),this.configureFlowStyles()}getStylesheet(){return this.graph.getStylesheet()}putCellStyle(e,t){this.getStylesheet().putCellStyle(e,t)}configureDefaultVertexStyle(){const e=this.getStylesheet().getDefaultVertexStyle();je(e),e[a.mxConstants.STYLE_ABSOLUTE_ARCSIZE]=!0,e[a.mxConstants.STYLE_ARCSIZE]=E.SHAPE_ARC_SIZE}configurePoolStyle(){const e={};e[a.mxConstants.STYLE_SHAPE]=a.mxConstants.SHAPE_SWIMLANE,e[a.mxConstants.STYLE_VERTICAL_ALIGN]=a.mxConstants.ALIGN_MIDDLE,e[a.mxConstants.STYLE_ALIGN]=a.mxConstants.ALIGN_CENTER,e[a.mxConstants.STYLE_STARTSIZE]=E.POOL_LABEL_SIZE,e[a.mxConstants.STYLE_FILLCOLOR]=E.POOL_LABEL_FILL_COLOR,this.graph.getStylesheet().putCellStyle(d.POOL,e)}configureLaneStyle(){const e={};e[a.mxConstants.STYLE_SHAPE]=a.mxConstants.SHAPE_SWIMLANE,e[a.mxConstants.STYLE_VERTICAL_ALIGN]=a.mxConstants.ALIGN_MIDDLE,e[a.mxConstants.STYLE_ALIGN]=a.mxConstants.ALIGN_CENTER,e[a.mxConstants.STYLE_SWIMLANE_LINE]=0,e[a.mxConstants.STYLE_STARTSIZE]=E.LANE_LABEL_SIZE,e[a.mxConstants.STYLE_FILLCOLOR]=E.LANE_LABEL_FILL_COLOR,this.graph.getStylesheet().putCellStyle(d.LANE,e)}configureEventStyles(){S.eventKinds().forEach(e=>{const t={};t[a.mxConstants.STYLE_SHAPE]=e,t[a.mxConstants.STYLE_PERIMETER]=a.mxPerimeter.EllipsePerimeter,t[a.mxConstants.STYLE_STROKEWIDTH]=e==d.EVENT_END?E.STROKE_WIDTH_THICK:E.STROKE_WIDTH_THIN,t[a.mxConstants.STYLE_VERTICAL_LABEL_POSITION]=a.mxConstants.ALIGN_BOTTOM,this.putCellStyle(e,t)})}configureTextAnnotationStyle(){const e={};e[a.mxConstants.STYLE_SHAPE]=d.TEXT_ANNOTATION,e[a.mxConstants.STYLE_VERTICAL_ALIGN]=a.mxConstants.ALIGN_MIDDLE,e[a.mxConstants.STYLE_ALIGN]=a.mxConstants.ALIGN_LEFT,e[a.mxConstants.STYLE_SPACING_LEFT]=5,e[a.mxConstants.STYLE_FILLCOLOR]=E.TEXT_ANNOTATION_FILL_COLOR,e[a.mxConstants.STYLE_STROKEWIDTH]=E.STROKE_WIDTH_THIN,this.putCellStyle(d.TEXT_ANNOTATION,e)}configureGroupStyle(){const e={};e[a.mxConstants.STYLE_ROUNDED]=!0,e[a.mxConstants.STYLE_DASHED]=!0,e[a.mxConstants.STYLE_DASH_PATTERN]="7 4 1 4",e[a.mxConstants.STYLE_STROKEWIDTH]=E.STROKE_WIDTH_THIN,e[a.mxConstants.STYLE_FILLCOLOR]=E.GROUP_FILL_COLOR,e[a.mxConstants.STYLE_ALIGN]=a.mxConstants.ALIGN_CENTER,e[a.mxConstants.STYLE_VERTICAL_ALIGN]=a.mxConstants.ALIGN_TOP,this.putCellStyle(d.GROUP,e)}configureActivityStyles(){S.activityKinds().forEach(e=>{const t={};t[a.mxConstants.STYLE_SHAPE]=e,t[a.mxConstants.STYLE_ROUNDED]=!0,t[a.mxConstants.STYLE_VERTICAL_ALIGN]=a.mxConstants.ALIGN_MIDDLE,t[a.mxConstants.STYLE_STROKEWIDTH]=e==d.CALL_ACTIVITY?E.STROKE_WIDTH_THICK:E.STROKE_WIDTH_THIN,this.putCellStyle(e,t)})}configureGatewayStyles(){S.gatewayKinds().forEach(e=>{const t={};t[a.mxConstants.STYLE_SHAPE]=e,t[a.mxConstants.STYLE_PERIMETER]=a.mxPerimeter.RhombusPerimeter,t[a.mxConstants.STYLE_STROKEWIDTH]=E.STROKE_WIDTH_THIN,t[a.mxConstants.STYLE_VERTICAL_ALIGN]=a.mxConstants.ALIGN_TOP,t[a.mxConstants.STYLE_LABEL_POSITION]=a.mxConstants.ALIGN_LEFT,t[a.mxConstants.STYLE_VERTICAL_LABEL_POSITION]=a.mxConstants.ALIGN_TOP,this.putCellStyle(e,t)})}configureDefaultEdgeStyle(){const e=this.getStylesheet().getDefaultEdgeStyle();je(e),e[a.mxConstants.STYLE_SHAPE]=m.EDGE,e[a.mxConstants.STYLE_ENDSIZE]=Ze,e[a.mxConstants.STYLE_STROKEWIDTH]=1.5,e[a.mxConstants.STYLE_ROUNDED]=!0,e[a.mxConstants.STYLE_ARCSIZE]=5,e[a.mxConstants.STYLE_VERTICAL_ALIGN]=a.mxConstants.ALIGN_BOTTOM,delete e[a.mxConstants.STYLE_ENDARROW]}configureEdgeStyles(e,t){e.forEach(s=>{const i={};t.get(s)(i),this.graph.getStylesheet().putCellStyle(s.toString(),i)})}configureFlowStyles(){this.configureEdgeStyles(Object.values(b),this.specificFlowStyles),this.configureEdgeStyles(Object.values(P),this.specificSequenceFlowStyles),this.configureEdgeStyles(Object.values(H),this.specificAssociationFlowStyles)}}function je(n){n[a.mxConstants.STYLE_FONTFAMILY]=E.DEFAULT_FONT_FAMILY,n[a.mxConstants.STYLE_FONTSIZE]=E.DEFAULT_FONT_SIZE,n[a.mxConstants.STYLE_FONTCOLOR]=E.DEFAULT_FONT_COLOR,n[a.mxConstants.STYLE_FILLCOLOR]=E.DEFAULT_FILL_COLOR,n[a.mxConstants.STYLE_STROKECOLOR]=E.DEFAULT_STROKE_COLOR,n[a.mxConstants.STYLE_LABEL_BACKGROUNDCOLOR]=a.mxConstants.NONE,n[a.mxConstants.STYLE_WHITE_SPACE]="wrap"}class Oe extends Map{get(e){return super.get(e)??(()=>{})}}function Xt(n,e,t,s){let i,o;n.height<n.width||n.height==n.width&&t.width<=t.height?(i=t.width,o=t.width*n.height/n.width):(i=t.height*n.width/n.height,o=t.height);const r=e.strokeWidth?(e.strokeWidth-1)*2:0,l=i*s-r,c=o*s-r;return{width:l,height:c}}class $t{constructor({canvas:e,shapeConfig:t,iconConfig:s}){g(this,"canvas");g(this,"iconOriginalSize");g(this,"scaleX");g(this,"scaleY");g(this,"iconPaintingOriginX",0);g(this,"iconPaintingOriginY",0);g(this,"shapeConfiguration");this.canvas=e,this.shapeConfiguration=t,this.iconOriginalSize=s.originalSize;const i=s.ratioFromParent;if(i){const o=Xt(this.iconOriginalSize,s.styleConfig,this.shapeConfiguration,i);this.scaleX=o.width/this.iconOriginalSize.width,this.scaleY=o.height/this.iconOriginalSize.height}else this.scaleX=1,this.scaleY=1;this.updateCanvasStyle(s.styleConfig),s.setIconOriginFunct(this)}setIconOriginToShapeTopLeftProportionally(e){const t=this.shapeConfiguration;this.iconPaintingOriginX=t.x+t.width/e,this.iconPaintingOriginY=t.y+t.height/e}setIconOriginToShapeTopLeft(e=E.SHAPE_ACTIVITY_TOP_MARGIN,t=E.SHAPE_ACTIVITY_LEFT_MARGIN){const s=this.shapeConfiguration;this.iconPaintingOriginX=s.x+t,this.iconPaintingOriginY=s.y+e}setIconOriginForIconCentered(){const e=this.shapeConfiguration;this.iconPaintingOriginX=e.x+(e.width-this.iconOriginalSize.width*this.scaleX)/2,this.iconPaintingOriginY=e.y+(e.height-this.iconOriginalSize.height*this.scaleY)/2}setIconOriginForIconBottomCentered(e=E.SHAPE_ACTIVITY_BOTTOM_MARGIN){const t=this.shapeConfiguration;this.iconPaintingOriginX=t.x+(t.width-this.iconOriginalSize.width*this.scaleX)/2,this.iconPaintingOriginY=t.y+(t.height-this.iconOriginalSize.height*this.scaleY-e)}setIconOriginForIconOnBottomLeft(e=E.SHAPE_ACTIVITY_BOTTOM_MARGIN,t=E.SHAPE_ACTIVITY_FROM_CENTER_MARGIN){const s=this.shapeConfiguration;this.iconPaintingOriginX=s.x+(s.width-this.iconOriginalSize.width*this.scaleX)/3-t,this.iconPaintingOriginY=s.y+(s.height-this.iconOriginalSize.height*this.scaleY-e)}translateIconOrigin(e,t){this.iconPaintingOriginX+=this.scaleX*e,this.iconPaintingOriginY+=this.scaleY*t}computeScaleFromOriginX(e){return this.iconPaintingOriginX+e*this.scaleX}computeScaleFromOriginY(e){return this.iconPaintingOriginY+e*this.scaleY}updateCanvasStyle({isFilled:e,strokeColor:t,fillColor:s,strokeWidth:i}){e?this.canvas.setFillColor(t):this.canvas.setFillColor(s),this.canvas.setStrokeWidth(i)}arcTo(e,t,s,i,o,r,l){this.canvas.arcTo(e*this.scaleX,t*this.scaleY,s,i,o,this.computeScaleFromOriginX(r),this.computeScaleFromOriginY(l))}begin(){this.canvas.begin()}close(){this.canvas.close()}curveTo(e,t,s,i,o,r){this.canvas.curveTo(this.computeScaleFromOriginX(e),this.computeScaleFromOriginY(t),this.computeScaleFromOriginX(s),this.computeScaleFromOriginY(i),this.computeScaleFromOriginX(o),this.computeScaleFromOriginY(r))}fill(){this.canvas.fill()}fillAndStroke(){this.canvas.fillAndStroke()}setFillColor(e){this.canvas.setFillColor(e)}stroke(){this.canvas.stroke()}setStrokeColor(e){this.canvas.setStrokeColor(e)}setRoundLineJoin(){this.canvas.setLineJoin("round")}lineTo(e,t){this.canvas.lineTo(this.computeScaleFromOriginX(e),this.computeScaleFromOriginY(t))}moveTo(e,t){this.canvas.moveTo(this.computeScaleFromOriginX(e),this.computeScaleFromOriginY(t))}rect(e,t,s,i){this.canvas.rect(this.computeScaleFromOriginX(e),this.computeScaleFromOriginY(t),s*this.scaleX,i*this.scaleY)}roundrect(e,t,s,i,o,r){this.canvas.roundrect(this.computeScaleFromOriginX(e),this.computeScaleFromOriginY(t),s*this.scaleX,i*this.scaleY,o,r)}ellipse(e,t,s,i){this.canvas.ellipse(this.computeScaleFromOriginX(e),this.computeScaleFromOriginY(t),s*this.scaleX,i*this.scaleY)}rotateOnIconCenter(e){const t=this.iconPaintingOriginX+this.iconOriginalSize.width/2*this.scaleX,s=this.iconPaintingOriginY+this.iconOriginalSize.height/2*this.scaleY;this.canvas.rotate(e,!1,!1,t,s)}}function $({canvas:n,x:e,y:t,width:s,height:i,shape:o,ratioFromParent:r,isFilled:l,iconStrokeWidth:c}){const u=o.strokewidth||a.mxUtils.getValue(o.style,a.mxConstants.STYLE_STROKEWIDTH,E.STROKE_WIDTH_THIN),h=o.fill||a.mxUtils.getValue(o.style,a.mxConstants.STYLE_FILLCOLOR,E.DEFAULT_FILL_COLOR),f=o.stroke||a.mxUtils.getValue(o.style,a.mxConstants.STYLE_STROKECOLOR,E.DEFAULT_STROKE_COLOR),p=a.mxUtils.getValue(o.style,a.mxConstants.STYLE_MARGIN,E.DEFAULT_MARGIN);return r??(r=.25),l??(l=!1),c??(c=0),{canvas:n,ratioFromParent:r,setIconOriginFunct:T=>T.setIconOriginForIconCentered(),shapeConfig:{x:e,y:t,width:s,height:i,strokeWidth:u},iconStyleConfig:{isFilled:l,fillColor:h,strokeColor:f,strokeWidth:c,margin:p}}}class U{paintEmptyIcon(){}newBpmnCanvas({canvas:e,ratioFromParent:t,setIconOriginFunct:s,shapeConfig:i,iconStyleConfig:o},r){return new $t({canvas:e,shapeConfig:i,iconConfig:{originalSize:r,styleConfig:o,ratioFromParent:t,setIconOriginFunct:s}})}paintEnvelopeIcon(e){const t={width:485.41,height:321.76},s=this.newBpmnCanvas(e,t),i=t.width,o=t.height;s.rect(0,0,i,o),s.fillAndStroke();const{iconStyleConfig:r}=e;r.isFilled&&s.setStrokeColor(r.fillColor),s.begin(),s.moveTo(0,0),s.lineTo(i*.5,o*.6),s.lineTo(i,0),s.moveTo(0,o),s.lineTo(i/3,o*.45),s.moveTo(i,o),s.lineTo(i*2/3,o*.45),s.stroke()}paintCircleIcon(e){const t={width:e.shapeConfig.width,height:e.shapeConfig.height},s=this.newBpmnCanvas(e,t),i=t.width,o=t.height;i>0&&o>0&&s.ellipse(0,0,i,o),e.iconStyleConfig.isFilled?s.fillAndStroke():s.stroke()}paintClockIcon(e){const t=this.newBpmnCanvas(e,{height:152,width:152});t.begin(),t.moveTo(184,60),t.curveTo(188.4,60,192,56.4,192,52),t.lineTo(192,48),t.curveTo(192,40,188.4,40,184,40),t.curveTo(179.6,40,176,43.6,176,48),t.lineTo(176,52),t.curveTo(176,56.4,179.6,60,184,60),t.close(),t.moveTo(184,308),t.curveTo(179.6,308,176,311.6,176,316),t.lineTo(176,320),t.curveTo(176,324.4,179.6,328,184,328),t.curveTo(188.4,328,192,324.4,192,320),t.lineTo(192,316),t.curveTo(192,311.6,188.4,308,184,308),t.close(),t.moveTo(52,176),t.lineTo(48,176),t.curveTo(43.6,176,40,179.6,40,184),t.curveTo(40,188.4,43.6,192,48,192),t.lineTo(52,192),t.curveTo(56.4,192,69,188.4,60,184),t.curveTo(60,179.6,56.4,176,52,176),t.close(),t.moveTo(320,176),t.lineTo(316,176),t.curveTo(311.6,176,308,179.6,308,184),t.curveTo(308,188.4,311.6,192,316,192),t.lineTo(320,192),t.curveTo(324.4,192,328,188.4,328,184),t.curveTo(328,179.6,324.4,176,320,176),t.moveTo(93.6,82.4),t.curveTo(90.4,79.2,85.6,79.2,82.4,82.4),t.curveTo(79.2,85.6,79.2,90.4,82.4,93.6),t.lineTo(85.2,96.4),t.curveTo(86.8,98,88.8,98.8,90.8,98.8),t.curveTo(92.8,98.8,94.4,98,96.4,96.4),t.curveTo(99.6,93.2,99.6,88.4,96.4,85.2),t.lineTo(93.6,82.4),t.moveTo(85.2,271.6),t.lineTo(82.4,274.4),t.curveTo(79.2,277.6,79.2,282.4,82.4,285.6),t.curveTo(84,287.2,86,288,88,288),t.curveTo(90,288,92,287.2,93.6,285.6),t.lineTo(96.4,282.8),t.curveTo(99.6,279.6,99.6,274.8,96.4,271.6),t.curveTo(93.2,268.4,88.4,268.4,85.2,271.6),t.moveTo(274.4,82.4),t.lineTo(271.6,85.2),t.curveTo(268.4,88.4,268.4,93.2,271.6,96.4),t.curveTo(273.298,98,275.2,98.8,277.2,98.8),t.curveTo(279.2,98.8,281.2,98,282.8,96.4),t.lineTo(285.6,93.6),t.curveTo(288.8,90.4,288.8,85.6,285.6,82.4),t.curveTo(282.4,79.2,277.6,79.2,274.4,82.4),t.moveTo(192,180.8),t.lineTo(192,108),t.curveTo(192,103.6,188.4,100,184,100),t.curveTo(179.6,100,176,103.6,176,108),t.lineTo(176,184),t.curveTo(176,186,176.8,188,178.4,189.6),t.lineTo(266,277.2),t.curveTo(267.6,278.8,269.6,279.6,271.6,279.6),t.curveTo(273.6,279.6,275.6,278.8,277.2,277.2),t.curveTo(280.4,274,280.4,269.2,277.2,266),t.lineTo(192,180.8),t.moveTo(184,0),t.curveTo(82.4,0,0,82.4,0,184),t.curveTo(0,285.6,82.4,368,184,368),t.curveTo(285.6,368,368,285.6,368,184),t.curveTo(368,82.4,285.6,0,184,0),t.moveTo(184,352),t.curveTo(91.2,352,16,276.8,16,184),t.curveTo(16,91.2,91.2,16,184,16),t.curveTo(276.8,16,352,91.2,352,184),t.curveTo(352,276.8,276.8,352,184,352),t.fillAndStroke()}paintTriangleIcon(e){const t=this.newBpmnCanvas(e,{height:735,width:849});t.begin(),t.moveTo(497,55),t.lineTo(817,609),t.curveTo(849,665,808,735,744,735),t.lineTo(105,735),t.curveTo(40,735,0,665,32,609),t.lineTo(352,55),t.curveTo(384,0,465,0,497,55),t.close(),t.fillAndStroke()}paintUpArrowheadIcon(e){const t=this.newBpmnCanvas(e,{height:50,width:40});t.begin(),t.moveTo(0,49.5),t.lineTo(19.5,1),t.curveTo(19.75,.25,20,0,20.25,.25),t.lineTo(40,49.5),t.curveTo(40,49.5,39.75,50,39.6,49.75),t.lineTo(20,30),t.lineTo(.4,49.75),t.curveTo(.4,49.75,.25,50,0,49.5),t.close(),t.fillAndStroke()}paintDoubleLeftArrowheadsIcon(e){const t=this.newBpmnCanvas(e,{height:53.5,width:105});t.begin(),t.moveTo(91.4,0),t.curveTo(91.4,0,91.2,0,91,.2),t.lineTo(50,25),t.curveTo(47.9,25.8,46.7,26.6,46.4,27.3),t.lineTo(46.4,0),t.curveTo(46.4,0,46.2,0,46,.2),t.lineTo(4.9,25),t.curveTo(2,26.2,0,27.3,4.9,28.5),t.lineTo(45.8,53),t.curveTo(46,53.3,46.2,53.5,46.4,53.5),t.lineTo(46.4,27),t.curveTo(46.6,27.3,47.8,28.1,49.9,29.9),t.lineTo(90.8,53.3),t.curveTo(91,53.3,91.2,53.5,91.4,53.5),t.lineTo(91.4,0),t.close(),t.fillAndStroke()}drawCrossIcon(e){const t=this.newBpmnCanvas(e,{height:1,width:1});return t.begin(),t.moveTo(.38,0),t.lineTo(.62,0),t.lineTo(.62,.38),t.lineTo(1,.38),t.lineTo(1,.62),t.lineTo(.62,.62),t.lineTo(.62,1),t.lineTo(.38,1),t.lineTo(.38,.62),t.lineTo(0,.62),t.lineTo(0,.38),t.lineTo(.38,.38),t.close(),t}paintListIcon(e){const t=this.newBpmnCanvas(e,{height:60,width:60});t.begin(),t.moveTo(0,0),t.lineTo(60,0),t.lineTo(60,60),t.lineTo(0,60),t.lineTo(0,0),t.close(),t.moveTo(5,5),t.lineTo(55,5),t.close(),t.moveTo(5,21.6),t.lineTo(55,21.6),t.close(),t.moveTo(5,38.3),t.lineTo(55,38.3),t.close(),t.moveTo(5,55),t.lineTo(55,55),t.close(),t.fillAndStroke()}paintXCrossIcon(e){const t=this.drawCrossIcon(e);t.rotateOnIconCenter(45),t.fillAndStroke()}paintPlusCrossIcon(e){this.drawCrossIcon(e).fillAndStroke()}paintAsteriskIcon(e){const t=this.newBpmnCanvas(e,{height:1,width:1});Le(e,t),t.fillAndStroke(),Le(e,t),t.rotateOnIconCenter(60),t.fillAndStroke(),Le(e,t),t.rotateOnIconCenter(240),t.fillAndStroke()}paintPersonIcon(e){const t=this.newBpmnCanvas({...e,iconStyleConfig:{...e.iconStyleConfig,isFilled:!0}},{height:239.68,width:143.61});t.begin(),t.moveTo(124.31,150.29),t.lineTo(99.66,141.03),t.arcTo(6.43,6.43,0,0,1,95.51,135.03),t.lineTo(95.51,130.66),t.arcTo(47.75,47.75,0,0,0,119.51,89.25),t.lineTo(119.51,71.25),t.arcTo(47.62,47.62,0,0,0,101.18,33.64),t.arcTo(29.35,29.35,0,0,0,101.52,29.14),t.arcTo(29.68,29.68,0,0,0,42.17,29.14),t.arcTo(29.24,29.24,0,0,0,42.53,33.63),t.arcTo(47.65,47.65,0,0,0,24.14,71.23),t.lineTo(24.14,89.23),t.arcTo(47.7,47.7,0,0,0,48.19,130.63),t.lineTo(48.19,135.03),t.arcTo(6.43,6.43,0,0,1,44.03,141.03),t.lineTo(19.31,150.29),t.arcTo(29.81,29.81,0,0,0,.09,178.03),t.lineTo(.09,233.51),t.arcTo(5.63,5.63,0,1,0,11.34,233.51),t.lineTo(11.34,178.03),t.arcTo(18.19,18.19,0,0,1,11.57,175.17),t.lineTo(20.5,184.11),t.arcTo(12.32,12.32,0,0,1,24.14,192.89),t.lineTo(24.14,233.51),t.arcTo(5.63,5.63,0,1,0,35.39,233.51),t.lineTo(35.39,192.93),t.arcTo(23.5,23.5,0,0,0,28.46,176.2),t.lineTo(17.04,164.78),t.arcTo(18.34,18.34,0,0,1,23.29,160.78),t.lineTo(43.65,153.15),t.lineTo(66.22,175.72),t.lineTo(66.22,233.51),t.arcTo(5.63,5.63,0,1,0,77.47,233.51),t.lineTo(77.47,175.76),t.lineTo(100.04,153.19),t.lineTo(120.4,160.82),t.arcTo(18.39,18.39,0,0,1,126.65,164.82),t.lineTo(115.24,176.24),t.arcTo(23.5,23.5,0,0,0,108.31,192.93),t.lineTo(108.31,233.55),t.arcTo(5.63,5.63,0,1,0,119.56,233.55),t.lineTo(119.56,192.93),t.arcTo(12.35,12.35,0,0,1,123.19,184.15),t.lineTo(132.13,175.22),t.arcTo(18,18,0,0,1,132.36,178.08),t.lineTo(132.36,233.56),t.arcTo(5.63,5.63,0,0,0,143.61,233.56),t.lineTo(143.61,178.03),t.arcTo(29.81,29.81,0,0,0,124.31,150.29),t.close(),t.moveTo(71.85,10.72),t.arcTo(18.46,18.46,0,0,1,90.17,27.18),t.arcTo(47.68,47.68,0,0,0,53.53,27.18),t.arcTo(18.44,18.44,0,0,1,71.85,10.72),t.close(),t.moveTo(35.39,71.23),t.arcTo(36.46,36.46,0,0,1,108.31,71.23),t.lineTo(108.31,77.4),t.curveTo(82.12,75.4,56.97,60.55,56.71,60.4),t.arcTo(5.62,5.62,0,0,0,48.78,62.71),t.curveTo(46.24,67.79,40.45,71.89,35.39,74.62),t.close(),t.moveTo(35.39,89.23),t.lineTo(35.39,87.08),t.curveTo(40.55,84.85,49.73,80.08,55.67,72.66),t.curveTo(64.83,77.46,85.92,87.21,108.31,88.66),t.lineTo(108.31,89.24),t.arcTo(36.46,36.46,0,1,1,35.39,89.24),t.close(),t.moveTo(71.85,165.45),t.lineTo(54.06,147.69),t.arcTo(17.7,17.7,0,0,0,59.43,135.32),t.arcTo(47.57,47.57,0,0,0,84.27,135.32),t.arcTo(17.7,17.7,0,0,0,89.64,147.69),t.close(),t.fill()}paintGearIcon(e){const t=this.newBpmnCanvas(e,{height:100,width:100});U.paintGearIconBackground(t),t.translateIconOrigin(14,14),U.paintGearIconForeground(t)}static paintGearIconBackground(e){e.begin(),e.moveTo(2.06,24.62),e.lineTo(10.17,30.95),e.lineTo(9.29,37.73),e.lineTo(0,41.42),e.lineTo(2.95,54.24),e.lineTo(13.41,52.92),e.lineTo(17.39,58.52),e.lineTo(13.56,67.66),e.lineTo(24.47,74.44),e.lineTo(30.81,66.33),e.lineTo(37.88,67.21),e.lineTo(41.57,76.5),e.lineTo(54.24,73.55),e.lineTo(53.06,62.94),e.lineTo(58.52,58.52),e.lineTo(67.21,63.09),e.lineTo(74.58,51.88),e.lineTo(66.03,45.25),e.lineTo(66.92,38.62),e.lineTo(76.5,34.93),e.lineTo(73.7,22.26),e.lineTo(62.64,23.44),e.lineTo(58.81,18.42),e.lineTo(62.79,8.7),e.lineTo(51.74,2.21),e.lineTo(44.81,10.47),e.lineTo(38.03,9.43),e.lineTo(33.75,0),e.lineTo(21.52,3.24),e.lineTo(22.7,13.56),e.lineTo(18.13,17.54),e.lineTo(8.7,13.56),e.close();const t=24.8,s=39;U.paintGearInnerCircle(e,t,s)}static paintGearIconForeground(e){e.begin(),e.moveTo(16.46,41.42),e.lineTo(24.57,47.75),e.lineTo(23.69,54.53),e.lineTo(14.4,58.22),e.lineTo(17.35,71.04),e.lineTo(27.81,69.72),e.lineTo(31.79,75.32),e.lineTo(27.96,84.46),e.lineTo(38.87,91.24),e.lineTo(45.21,83.13),e.lineTo(52.28,84.01),e.lineTo(55.97,93.3),e.lineTo(68.64,90.35),e.lineTo(67.46,79.74),e.lineTo(72.92,75.32),e.lineTo(81.61,79.89),e.lineTo(88.98,68.68),e.lineTo(80.43,62.05),e.lineTo(81.32,55.42),e.lineTo(90.9,51.73),e.lineTo(88.1,39.06),e.lineTo(77.04,40.24),e.lineTo(73.21,35.22),e.lineTo(77.19,25.5),e.lineTo(66.14,19.01),e.lineTo(59.21,27.27),e.lineTo(52.43,26.23),e.lineTo(48.15,16.8),e.lineTo(35.92,20.04),e.lineTo(37.1,30.36),e.lineTo(32.53,34.34),e.lineTo(23.1,30.36),e.close();const t=39.2,s=55.8;U.paintGearInnerCircle(e,t,s),e.begin(),U.paintGearInnerCircle(e,t,s)}static paintGearInnerCircle(e,t,s){e.moveTo(t,s),e.arcTo(13.5,13.5,0,1,1,t+2*13.5,s),e.arcTo(13.5,13.5,0,0,1,t,s),e.close(),e.fillAndStroke()}paintExpandIcon(e){const t={width:16,height:16},s=this.newBpmnCanvas(e,t),i=t.width,o=t.height;s.roundrect(0,0,i,o,2,2),s.stroke(),s.begin(),s.moveTo(i/2,o/4),s.lineTo(i/2,o*3/4),s.close(),s.moveTo(i/4,o/2),s.lineTo(i*3/4,o/2),s.close(),s.fillAndStroke()}paintLoopIcon(e){const{iconStyleConfig:t}=e;t.fillColor=t.strokeColor;const s=this.newBpmnCanvas(e,{width:22.49,height:21.62});s.begin(),s.moveTo(5.5,19.08),s.arcTo(8,8,0,1,1,10.5,21.08),s.stroke(),s.begin(),s.moveTo(7.5,14.08),s.lineTo(5.75,19.08),s.lineTo(0,17.08),s.close(),s.fillAndStroke()}paintSequentialMultiInstanceIcon(e){const t={width:16,height:16},s=this.newBpmnCanvas(e,t),{canvas:i,iconStyleConfig:o}=e;i.setFillColor(o.strokeColor);const r=t.width,l=t.height/5;s.rect(0,0,r,l),s.fill(),s.rect(0,2*l,r,l),s.fill(),s.rect(0,4*l,r,l),s.fill()}paintParallelMultiInstanceIcon(e){const t={width:16,height:16},s=this.newBpmnCanvas(e,t),{canvas:i,iconStyleConfig:o}=e;i.setFillColor(o.strokeColor);const r=t.width/5,l=t.height;s.begin(),s.rect(0,0,r,l),s.fill(),s.rect(2*r,0,r,l),s.fill(),s.rect(4*r,0,r,l),s.fill()}paintRightArrowIcon(e){const t=this.newBpmnCanvas(e,{width:512,height:415.23});t.setRoundLineJoin(),t.begin(),t.moveTo(512,207.61),t.lineTo(304.38,0),t.lineTo(304.38,135.39),t.lineTo(0,135.39),t.lineTo(0,279.84),t.lineTo(304.38,279.84),t.lineTo(304.38,415.23),t.lineTo(512,207.61),t.close(),t.fillAndStroke()}paintErrorIcon(e){const t=this.newBpmnCanvas(e,{width:72.44,height:71.82});t.begin(),t.moveTo(0,53.32),t.lineTo(19.48,0),t.lineTo(19.48,0),t.lineTo(50.85,40.07),t.lineTo(72.44,18.21),t.lineTo(53.12,71.82),t.lineTo(22.5,31.37),t.close(),t.fillAndStroke()}paintHandIcon(e){const t=this.newBpmnCanvas(e,{width:343.65,height:354.12});t.begin(),t.moveTo(231.66,336.39),t.curveTo(240.84,316.9,220.53,306.92,220.53,306.92),t.curveTo(215.2,303.67,188.58,287.43,140.67,258.19),t.lineTo(146.33,248.39),t.curveTo(223.98,269.38,267.12,281.04,275.75,283.38),t.curveTo(275.75,283.38,297.25,288,301.42,267.77),t.curveTo(306.34,245.29,288.32,238.63,288.32,238.63),t.curveTo(279.91,236.44,237.86,225.48,162.18,205.75),t.lineTo(165.2,194.8),t.curveTo(255.88,204.4,306.27,209.73,316.34,210.8),t.curveTo(316.34,210.8,339.89,212.16,341.76,189.55),t.curveTo(343.65,166.93,320.5,164.13,320.5,164.13),t.curveTo(310.43,163.1,260.04,157.99,169.35,148.77),t.lineTo(169.35,138.97),t.curveTo(253.41,132.12,300.11,128.32,309.45,127.56),t.curveTo(309.45,127.56,332.27,122.38,332.27,102.61),t.curveTo(332.27,82.85,305.48,81.87,305.48,81.87),t.curveTo(293.99,82.2,236.54,83.88,133.13,86.9),t.lineTo(127.61,81.87),t.curveTo(145.3,59.39,155.12,46.9,157.09,44.41),t.curveTo(157.09,44.41,171.12,26.8,156.78,12.72),t.curveTo(143.83,0,124.08,14.49,124.08,14.49),t.curveTo(116.45,19.41,78.35,44.06,9.77,88.43),t.lineTo(0,251.94),t.curveTo(122.84,308.79,191.09,340.37,204.74,346.69),t.curveTo(204.74,346.69,222.91,354.12,231.66,336.39),t.fillAndStroke()}paintScriptIcon(e){e.iconStyleConfig.fillColor=e.iconStyleConfig.strokeColor;const t=this.newBpmnCanvas(e,{width:458.75,height:461.64});t.begin(),t.moveTo(67.85,.57),t.curveTo(50.73,0,33.26,8.86,22.35,18.84),t.curveTo(8.11,32.15,0,50.77,0,70.26),t.curveTo(0,73.15,0,87.59,0,113.6),t.curveTo(55.4,113.6,86.18,113.6,92.33,113.6),t.curveTo(94.92,150.46,85.64,180.4,74.22,211.27),t.curveTo(40.16,298.07,30.77,339.83,55.56,410.87),t.curveTo(63.72,438.26,87.59,457.85,114.91,461.09),t.curveTo(216.96,460.85,294.9,461.64,388.41,461.2),t.curveTo(407.2,461.09,425.14,453.55,438.3,440.13),t.curveTo(451.46,426.71,458.75,403.06,458.46,384.26),t.curveTo(458.43,382.23,458.18,365.93,458.15,363.89),t.curveTo(432.12,364.24,406.09,364.04,380.06,364.04),t.curveTo(377.61,347.52,377.24,337.58,378.28,324.48),t.curveTo(380.5,296.47,389.08,273.36,398.59,247.1),t.curveTo(408.11,220.83,418.41,191.47,420.86,154.24),t.curveTo(422.11,135.34,421.4,110.24,417.77,86.75),t.curveTo(417.76,86.71,417.73,86.54,417.69,86.22),t.curveTo(417.64,85.95,417.61,85.79,417.6,85.76),t.curveTo(414.03,68.13,410.49,48.84,399.79,31.47),t.curveTo(389.09,14.11,366.95,.59,341.75,.59),t.curveTo(286.97,.59,122.63,.57,67.85,.57),t.close(),t.moveTo(85.04,72.68),t.curveTo(80.63,72.68,45.33,72.68,40.92,72.68),t.curveTo(40.46,58.4,47.15,51.87,50.27,48.75),t.curveTo(55.8,44.28,59.84,41,73.82,41),t.curveTo(78.45,52.13,82.23,62.71,85.04,72.68),t.close(),t.moveTo(364.94,52.9),t.curveTo(370,61.11,373.9,76.44,377.38,93.51),t.curveTo(380.35,113.1,381.01,136.42,380.02,151.57),t.curveTo(377.97,182.76,369.51,207.12,360.1,233.1),t.curveTo(350.69,259.09,340.27,286.77,337.53,321.27),t.curveTo(336.38,335.86,336.72,346.69,338.87,364.01),t.curveTo(326.35,364.01,263.75,364.01,151.06,364.01),t.curveTo(151.06,382.2,151.06,392.31,151.06,394.33),t.curveTo(147.77,404.8,138.9,418.2,127.43,419.94),t.curveTo(111.49,422.35,97.86,411.8,94.75,399.19),t.curveTo(65.14,321.99,94.93,275.54,112.57,225.47),t.curveTo(130.14,177.95,137.92,117.41,112.71,42.09),t.curveTo(192.88,41.9,274.33,42.21,342.89,41.98),t.curveTo(357.15,42.03,359.83,44.61,364.94,52.9),t.close(),t.moveTo(409.96,399.48),t.curveTo(409.96,408.42,398.54,425.67,392.02,425.67),t.curveTo(325.19,425.79,252.29,425.67,185.23,425.67),t.curveTo(189.88,424.43,194.66,405.64,194.66,399.48),t.curveTo(237.72,399.48,388.43,399.48,409.96,399.48),t.close(),t.fill(),t.begin(),t.moveTo(182.1,131.2),t.lineTo(182.1,151.68),t.lineTo(321.89,151.68),t.lineTo(321.89,131.2),t.lineTo(182.1,131.2),t.close(),t.moveTo(162.25,251.09),t.lineTo(162.25,271.49),t.lineTo(301.96,271.49),t.lineTo(301.96,251.09),t.lineTo(162.25,251.09),t.close(),t.fill()}paintTableIcon(e){const t=this.newBpmnCanvas(e,{width:640,height:640});t.begin(),t.moveTo(.19,.1),t.lineTo(298.78,.1),t.lineTo(298.78,198.88),t.lineTo(.19,198.88),t.lineTo(.19,.1),t.close(),t.fillAndStroke(),t.begin(),t.moveTo(0,0),t.lineTo(298.78,0),t.lineTo(298.78,48.88),t.lineTo(0,48.88),t.lineTo(0,0),t.close(),t.fillAndStroke(),t.begin(),t.moveTo(0,48.88),t.lineTo(98.78,48.88),t.lineTo(98.78,198.88),t.lineTo(0,198.88),t.lineTo(0,48.88),t.close(),t.fillAndStroke(),t.begin(),t.moveTo(1.09,122.69),t.lineTo(298.78,122.69),t.close(),t.fillAndStroke(),t.setFillColor(e.iconStyleConfig.strokeColor),t.begin(),t.moveTo(0,0),t.lineTo(298.78,0),t.lineTo(298.78,48.88),t.lineTo(0,48.88),t.lineTo(0,0),t.close(),t.fillAndStroke()}paintPentagon(e){const t=this.newBpmnCanvas(e,{width:16,height:16});t.begin(),t.moveTo(16,6.5),t.lineTo(8,0),t.lineTo(0,6.5),t.lineTo(3,16),t.lineTo(13,16),t.lineTo(16,6.5),t.lineTo(8,0),t.stroke()}}function Le(n,e){e.begin(),e.moveTo(.38,0),e.lineTo(.62,0),e.lineTo(.62,1),e.lineTo(.38,1),e.close()}class Z{static get(){return this.instance}static set(e){this.instance=e}}g(Z,"instance",new U);class D extends a.mxEllipse{constructor(){super(void 0,void 0,void 0);g(this,"iconPainter",Z.get());g(this,"iconPainters",new Map([[_.MESSAGE,t=>this.iconPainter.paintEnvelopeIcon({...t,ratioFromParent:.5})],[_.TERMINATE,t=>this.iconPainter.paintCircleIcon({...t,ratioFromParent:.6})],[_.TIMER,t=>this.iconPainter.paintClockIcon({...t,setIconOriginFunct:s=>s.setIconOriginToShapeTopLeftProportionally(5)})],[_.SIGNAL,t=>this.iconPainter.paintTriangleIcon({...t,ratioFromParent:.55,iconStyleConfig:{...t.iconStyleConfig,strokeWidth:E.STROKE_WIDTH_THIN.valueOf()},setIconOriginFunct:s=>s.setIconOriginToShapeTopLeftProportionally(4)})],[_.LINK,t=>this.iconPainter.paintRightArrowIcon({...t,ratioFromParent:.55,iconStyleConfig:{...t.iconStyleConfig,strokeWidth:1.5}})],[_.ERROR,t=>this.iconPainter.paintErrorIcon({...t,ratioFromParent:.55,iconStyleConfig:{...t.iconStyleConfig,strokeWidth:1.5}})],[_.COMPENSATION,t=>this.iconPainter.paintDoubleLeftArrowheadsIcon({...t,ratioFromParent:.7,iconStyleConfig:{...t.iconStyleConfig,strokeWidth:1.5}})],[_.CANCEL,t=>this.iconPainter.paintXCrossIcon({...t,ratioFromParent:.78})],[_.ESCALATION,t=>this.iconPainter.paintUpArrowheadIcon({...t,ratioFromParent:.55,iconStyleConfig:{...t.iconStyleConfig,strokeWidth:E.STROKE_WIDTH_THIN.valueOf()}})],[_.CONDITIONAL,t=>this.iconPainter.paintListIcon({...t,ratioFromParent:.6,iconStyleConfig:{...t.iconStyleConfig,strokeWidth:1.5}})]]));g(this,"withFilledIcon",!1)}paintVertexShape(t,s,i,o,r){const l=$({canvas:t,x:s,y:i,width:o,height:r,shape:this,isFilled:this.withFilledIcon});D.setDashedOuterShapePattern(l,a.mxUtils.getValue(this.style,m.IS_INTERRUPTING,void 0)),this.paintOuterShape(l),D.restoreOriginalOuterShapePattern(l),this.paintInnerShape(l)}paintOuterShape({canvas:t,shapeConfig:{x:s,y:i,width:o,height:r}}){super.paintVertexShape(t,s,i,o,r)}paintInnerShape(t){(this.iconPainters.get(a.mxUtils.getValue(this.style,m.EVENT_DEFINITION_KIND,_.NONE))??(()=>this.iconPainter.paintEmptyIcon()))(t)}static setDashedOuterShapePattern(t,s){t.canvas.save(),s==="false"&&(t.canvas.setDashed(!0,!1),t.canvas.setDashPattern("3 2"))}static restoreOriginalOuterShapePattern(t){t.canvas.restore()}}class Zt extends D{constructor(){super(),this.withFilledIcon=!0}}class ye extends D{paintOuterShape({canvas:e,shapeConfig:{x:t,y:s,width:i,height:o,strokeWidth:r}}){e.ellipse(t,s,i,o),e.fillAndStroke();const l=r*1.5;e.ellipse(i*.02+l+t,o*.02+l+s,i*.96-2*l,o*.96-2*l),e.stroke()}}class jt extends ye{constructor(){super(),this.withFilledIcon=!0}}class ae extends a.mxRhombus{constructor(){super(...arguments);g(this,"iconPainter",Z.get())}paintVertexShape(t,s,i,o,r){const l=$({canvas:t,x:s,y:i,width:o,height:r,shape:this});this.paintOuterShape(l),this.paintInnerShape(l)}paintOuterShape({canvas:t,shapeConfig:{x:s,y:i,width:o,height:r}}){super.paintVertexShape(t,s,i,o,r)}}class qt extends ae{paintInnerShape(e){this.iconPainter.paintXCrossIcon({...e,iconStyleConfig:{...e.iconStyleConfig,isFilled:!0},ratioFromParent:.5})}}class Qt extends ae{paintInnerShape(e){this.iconPainter.paintPlusCrossIcon({...e,iconStyleConfig:{...e.iconStyleConfig,isFilled:!0},ratioFromParent:.5})}}class Jt extends ae{paintInnerShape(e){this.iconPainter.paintCircleIcon({...e,ratioFromParent:.62,iconStyleConfig:{...e.iconStyleConfig,isFilled:!1,strokeWidth:E.STROKE_WIDTH_THICK.valueOf()}})}}class en extends ae{paintInnerShape(e){this.iconPainter.paintAsteriskIcon({...e,iconStyleConfig:{...e.iconStyleConfig,isFilled:!0},ratioFromParent:.5})}}class tn extends ae{paintInnerShape(e){e={...e,iconStyleConfig:{...e.iconStyleConfig,strokeWidth:1}},this.iconPainter.paintCircleIcon({...e,ratioFromParent:.55}),ct(this.style)||this.iconPainter.paintCircleIcon({...e,ratioFromParent:.45});const t={...e,ratioFromParent:.3};a.mxUtils.getValue(this.style,m.EVENT_BASED_GATEWAY_KIND,se.Exclusive)==se.Parallel?this.iconPainter.paintPlusCrossIcon(t):this.iconPainter.paintPentagon(t)}}const nn=[v.LOOP,v.MULTI_INSTANCE_PARALLEL,v.MULTI_INSTANCE_SEQUENTIAL,v.COMPENSATION,v.EXPAND,v.ADHOC];function sn(n){const e=nn.filter(t=>n.includes(t));return n.filter(t=>!e.includes(t)).forEach(t=>e.push(t)),e}function dt(n,e){Z.get().paintEnvelopeIcon({...n,setIconOriginFunct:t=>t.setIconOriginToShapeTopLeft(),ratioFromParent:.2,iconStyleConfig:{...n.iconStyleConfig,isFilled:e}})}class ke extends a.mxRectangleShape{constructor(){super(void 0,void 0,void 0);g(this,"iconPainter",Z.get())}paintForeground(t,s,i,o,r){super.paintForeground(t,s,i,o,r),this.paintMarkerIcons($({canvas:t,x:s,y:i,width:o,height:r,shape:this,ratioFromParent:0,iconStrokeWidth:1.5}))}paintMarkerIcons(t){const s=a.mxUtils.getValue(this.style,m.MARKERS,void 0);s&&sn(s.split(",")).forEach((i,o,r)=>{switch(t={...t,setIconOriginFunct:this.getMarkerIconOriginFunction(r.length,o+1)},t.canvas.save(),i){case v.LOOP:this.iconPainter.paintLoopIcon(t);break;case v.MULTI_INSTANCE_SEQUENTIAL:this.iconPainter.paintSequentialMultiInstanceIcon(t);break;case v.MULTI_INSTANCE_PARALLEL:this.iconPainter.paintParallelMultiInstanceIcon(t);break;case v.EXPAND:this.iconPainter.paintExpandIcon(t);break}t.canvas.restore()})}getMarkerIconOriginFunction(t,s){let i;return t===1?i=o=>o.setIconOriginForIconBottomCentered():i=o=>{o.setIconOriginForIconBottomCentered();const r=Math.pow(-1,s)*(E.SHAPE_ACTIVITY_MARKER_ICON_SIZE/2+E.SHAPE_ACTIVITY_MARKER_ICON_MARGIN);o.translateIconOrigin(r,0)},i}}class G extends ke{paintForeground(e,t,s,i,o){super.paintForeground(e,t,s,i,o),this.paintTaskIcon($({canvas:e,x:t,y:s,width:i,height:o,shape:this}))}}class on extends G{paintTaskIcon(e){this.iconPainter.paintEmptyIcon()}}class rn extends G{paintTaskIcon(e){this.iconPainter.paintGearIcon({...e,setIconOriginFunct:t=>t.setIconOriginToShapeTopLeftProportionally(20)})}}class an extends G{paintTaskIcon(e){this.iconPainter.paintPersonIcon({...e,setIconOriginFunct:t=>t.setIconOriginToShapeTopLeftProportionally(20)})}}class ln extends G{paintTaskIcon(e){if(!ct(this.style)){dt(e,!1);return}const t=4,s=4,i={...e.shapeConfig,width:20,height:20};this.iconPainter.paintCircleIcon({canvas:e.canvas,shapeConfig:i,iconStyleConfig:{...e.iconStyleConfig,isFilled:!1},ratioFromParent:void 0,setIconOriginFunct:o=>o.setIconOriginToShapeTopLeft(s,t)}),i.x+=t,i.y+=s,this.iconPainter.paintEnvelopeIcon({...e,shapeConfig:i,ratioFromParent:.65,setIconOriginFunct:o=>o.setIconOriginForIconCentered()})}}class cn extends G{paintTaskIcon(e){dt(e,!0)}}class un extends G{paintTaskIcon(e){this.iconPainter.paintHandIcon({...e,ratioFromParent:.18,setIconOriginFunct:t=>t.setIconOriginToShapeTopLeftProportionally(20)})}}class dn extends G{paintTaskIcon(e){this.iconPainter.paintScriptIcon({...e,ratioFromParent:.22,setIconOriginFunct:t=>t.setIconOriginToShapeTopLeftProportionally(20)})}}class hn extends ke{paintForeground(e,t,s,i,o){super.paintForeground(e,t,s,i,o);const r=$({canvas:e,x:t,y:s,width:i,height:o,shape:this});switch(a.mxUtils.getValue(this.style,m.GLOBAL_TASK_KIND,void 0)){case d.GLOBAL_TASK_MANUAL:this.iconPainter.paintHandIcon({...r,ratioFromParent:.18,setIconOriginFunct:l=>l.setIconOriginToShapeTopLeftProportionally(20)});break;case d.GLOBAL_TASK_SCRIPT:this.iconPainter.paintScriptIcon({...r,ratioFromParent:.22,setIconOriginFunct:l=>l.setIconOriginToShapeTopLeftProportionally(20)});break;case d.GLOBAL_TASK_USER:this.iconPainter.paintPersonIcon({...r,setIconOriginFunct:l=>l.setIconOriginToShapeTopLeftProportionally(20)});break;case d.GLOBAL_TASK_BUSINESS_RULE:this.iconPainter.paintTableIcon({...r,ratioFromParent:.6,setIconOriginFunct:l=>l.setIconOriginToShapeTopLeftProportionally(15)});break;case d.GLOBAL_TASK:default:this.iconPainter.paintEmptyIcon()}}}class gn extends ke{paintBackground(e,t,s,i,o){const r=a.mxUtils.getValue(this.style,m.SUB_PROCESS_KIND,void 0);e.save(),r===he.EVENT&&(e.setDashed(!0,!1),e.setDashPattern("1 2")),super.paintBackground(e,t,s,i,o),e.restore()}}class fn extends G{paintTaskIcon(e){this.iconPainter.paintTableIcon({...e,ratioFromParent:.6,setIconOriginFunct:t=>t.setIconOriginToShapeTopLeftProportionally(15)})}}class Tn extends a.mxRectangleShape{paintForeground(e,t,s,i,o){e.begin(),e.moveTo(t+E.TEXT_ANNOTATION_BORDER_LENGTH,s),e.lineTo(t,s),e.lineTo(t,s+o),e.lineTo(t+E.TEXT_ANNOTATION_BORDER_LENGTH,s+o),e.stroke()}paintBackground(e,t,s,i,o){e.save(),e.setStrokeColor("none"),super.paintBackground(e,t,s,i,o),e.restore()}}class pn extends a.mxRectangleShape{constructor(t,s,i,o){super(t,s,i,o);g(this,"iconPainter",Z.get())}paintVertexShape(t,s,i,o,r){const l=$({canvas:t,x:s,y:i,width:o,height:r,shape:this,ratioFromParent:1,isFilled:a.mxUtils.getValue(this.style,m.IS_INITIATING,"true")=="false"});this.iconPainter.paintEnvelopeIcon(l)}}function En(n,e){return mn(n.style,e)}function mn(n,e){const t=[],s=n.split(";"),o=s[0].replace(/shape=bpmn./g,""),r=new Map;return r.set("bpmn-type-activity",S.isActivity(o)),r.set("bpmn-type-container",S.isPoolOrLane(o)),r.set("bpmn-type-event",S.isEvent(o)),r.set("bpmn-type-flow",Cn(o)),r.set("bpmn-type-gateway",S.isGateway(o)),r.set("bpmn-type-task",S.isTask(o)),[...r].filter(([,l])=>l).forEach(([l])=>t.push(l)),t.push(we(o)),s.map(l=>{const c=l.split("=");return[c[0],c[1]]}).forEach(([l,c])=>{switch(l){case m.EVENT_DEFINITION_KIND:t.push(`bpmn-event-def-${c}`);break;case m.EVENT_BASED_GATEWAY_KIND:t.push(`bpmn-gateway-kind-${c.toLowerCase()}`);break;case m.IS_INITIATING:t.push(c=="true"?"bpmn-icon-initiating":"bpmn-icon-non-initiating");break;case m.SUB_PROCESS_KIND:t.push(`bpmn-sub-process-${c.toLowerCase()}`);break;case m.GLOBAL_TASK_KIND:t.push(we(c));break}}),e&&t.push("bpmn-label"),t}function Cn(n){return Object.values(b).map(e=>e).includes(n)}function we(n){return n?"bpmn-"+n.replace(/([A-Z])/g,e=>"-"+e[0].toLowerCase()):""}class ht extends a.mxCellOverlay{constructor(t,s){super(null,"",s.position.horizontalAlign,s.position.verticalAlign,null,"default");g(this,"style");this.label=t,this.style=s.style}getBounds(t){const s=t.view.graph.getModel().isEdge(t.cell),i=t.view.scale;let o;const r=0,l=0;return s?o=this.computeEdgeBounds(t):(o=new a.mxPoint,this.align==a.mxConstants.ALIGN_LEFT?o.x=t.x:this.align==a.mxConstants.ALIGN_CENTER?o.x=t.x+t.width/2:o.x=t.x+t.width,this.verticalAlign==a.mxConstants.ALIGN_TOP?o.y=t.y:this.verticalAlign==a.mxConstants.ALIGN_MIDDLE?o.y=t.y+t.height/2:o.y=t.y+t.height),new a.mxRectangle(Math.round(o.x-(r*this.defaultOverlap-this.offset.x)*i),Math.round(o.y-(l*this.defaultOverlap-this.offset.y)*i),r*i,l*i)}computeEdgeBounds(t){const s=t.absolutePoints;if(this.align==a.mxConstants.ALIGN_LEFT)return s[0];if(this.align==a.mxConstants.ALIGN_CENTER){if(s.length%2==1)return s[Math.floor(s.length/2)];{const i=s.length/2,o=s[i-1],r=s[i];return new a.mxPoint(o.x+(r.x-o.x)/2,o.y+(r.y-o.y)/2)}}else return s[s.length-1]}}class qe extends a.mxText{constructor(e,t,s){super(e,t,void 0,void 0,s.font.color,void 0,s.font.size,void 0,void 0,void 0,void 0,void 0,void 0,void 0,s.fill.color,s.stroke.color),this.fillOpacity=s.fill.opacity,this.strokewidth=s.stroke.width}}class Sn extends a.mxConnector{constructor(e,t,s){super(e,t,s)}paintEdgeShape(e,t){const s=this.createMarker(e,t,!0),i=this.createMarker(e,t,!1);this.paintEdgeLine(e,t),e.setShadow(!1),e.setDashed(!1,!1),s!=null&&(e.setFillColor(a.mxUtils.getValue(this.style,m.EDGE_START_FILL_COLOR,this.stroke)),s()),i!=null&&(e.setFillColor(a.mxUtils.getValue(this.style,m.EDGE_END_FILL_COLOR,this.stroke)),i())}paintEdgeLine(e,t){const s=In(e);Qe(e,"stroke"),this.paintLine(e,t,this.isRounded),Qe(e,s)}}function In(n){return n instanceof a.mxSvgCanvas2D?n.pointerEventsValue:null}function Qe(n,e){n instanceof a.mxSvgCanvas2D&&(n.pointerEventsValue=e)}class An{configureShapes(){this.initMxSvgCanvasPrototype(),this.initMxShapePrototype(),this.registerShapes(),this.initMxCellRendererCreateCellOverlays()}registerShapes(){a.mxCellRenderer.registerShape(d.EVENT_END,Zt),a.mxCellRenderer.registerShape(d.EVENT_START,D),a.mxCellRenderer.registerShape(d.EVENT_INTERMEDIATE_THROW,jt),a.mxCellRenderer.registerShape(d.EVENT_INTERMEDIATE_CATCH,ye),a.mxCellRenderer.registerShape(d.EVENT_BOUNDARY,ye),a.mxCellRenderer.registerShape(d.GATEWAY_COMPLEX,en),a.mxCellRenderer.registerShape(d.GATEWAY_EVENT_BASED,tn),a.mxCellRenderer.registerShape(d.GATEWAY_EXCLUSIVE,qt),a.mxCellRenderer.registerShape(d.GATEWAY_INCLUSIVE,Jt),a.mxCellRenderer.registerShape(d.GATEWAY_PARALLEL,Qt),a.mxCellRenderer.registerShape(d.SUB_PROCESS,gn),a.mxCellRenderer.registerShape(d.CALL_ACTIVITY,hn),a.mxCellRenderer.registerShape(d.TASK,on),a.mxCellRenderer.registerShape(d.TASK_SERVICE,rn),a.mxCellRenderer.registerShape(d.TASK_USER,an),a.mxCellRenderer.registerShape(d.TASK_RECEIVE,ln),a.mxCellRenderer.registerShape(d.TASK_SEND,cn),a.mxCellRenderer.registerShape(d.TASK_MANUAL,un),a.mxCellRenderer.registerShape(d.TASK_SCRIPT,dn),a.mxCellRenderer.registerShape(d.TASK_BUSINESS_RULE,fn),a.mxCellRenderer.registerShape(d.TEXT_ANNOTATION,Tn),a.mxCellRenderer.registerShape(m.EDGE,Sn),a.mxCellRenderer.registerShape(m.MESSAGE_FLOW_ICON,pn)}initMxSvgCanvasPrototype(){a.mxSvgCanvas2D.prototype.getTextCss=function(){const e=this.state,t=a.mxConstants.ABSOLUTE_LINE_HEIGHT?e.fontSize*a.mxConstants.LINE_HEIGHT+"px":a.mxConstants.LINE_HEIGHT*this.lineHeightCorrection;let s="display: inline-block; font-size: "+e.fontSize+"px; font-family: "+e.fontFamily+"; color: "+e.fontColor+"; line-height: "+t+"; pointer-events: none; ";(e.fontStyle&a.mxConstants.FONT_BOLD)==a.mxConstants.FONT_BOLD&&(s+="font-weight: bold; "),(e.fontStyle&a.mxConstants.FONT_ITALIC)==a.mxConstants.FONT_ITALIC&&(s+="font-style: italic; ");const i=[];return(e.fontStyle&a.mxConstants.FONT_UNDERLINE)==a.mxConstants.FONT_UNDERLINE&&i.push("underline"),(e.fontStyle&a.mxConstants.FONT_STRIKETHROUGH)==a.mxConstants.FONT_STRIKETHROUGH&&i.push("line-through"),i.length>0&&(s+="text-decoration: "+i.join(" ")+"; "),s}}initMxShapePrototype(){a.mxShape.prototype.createSvgCanvas=function(){var s;const e=new a.mxSvgCanvas2D(this.node,!1);e.strokeTolerance=this.pointerEvents?this.svgStrokeTolerance:0,e.pointerEventsValue=this.svgPointerEvents;const t=this.getSvgScreenOffset();if(t!=0?this.node.setAttribute("transform","translate("+t+","+t+")"):this.node.removeAttribute("transform"),(s=this.state)!=null&&s.cell){const i=this.state.cell;let o=En(i,this.dialect===a.mxConstants.DIALECT_STRICTHTML);const r=this.state.style[m.EXTRA_CSS_CLASSES];typeof r=="string"&&(o=o.concat(r.split(","))),this.node.setAttribute("class",o.join(" ")),this.node.setAttribute("data-bpmn-id",this.state.cell.id)}return e.minStrokeWidth=this.minSvgStrokeWidth,this.antiAlias||(e.format=function(i){return Math.round(parseFloat(i))}),e}}initMxCellRendererCreateCellOverlays(){a.mxCellRenderer.prototype.createCellOverlays=function(e){const s=e.view.graph.getCellOverlays(e.cell);let i=null;if(s!=null){i=new a.mxDictionary;for(const o of s){const r=e.overlays!=null?e.overlays.remove(o):null;if(r!=null){i.put(o,r);continue}let l;o instanceof ht?l=new qe(o.label,new a.mxRectangle(0,0,0,0),o.style):(l=new a.mxImageShape(new a.mxRectangle(0,0,0,0),o.image.src),l.preserveImageAspect=!1),l.dialect=e.view.graph.dialect,l.overlay=o,this.initializeOverlay(e,l),this.installCellOverlayListeners(e,o,l),o.cursor!=null&&(l.node.style.cursor=o.cursor),l instanceof qe&&(l.node.classList.add("overlay-badge"),l.node.setAttribute("data-bpmn-id",e.cell.id)),i.put(o,l)}}e.overlays!=null&&e.overlays.visit(function(o,r){r.destroy()}),e.overlays=i}}}class On{configureMarkers(){this.registerArrowDashMarker()}registerArrowDashMarker(){const e=(t,s,i,o,r,l,c,u,h)=>{const f=r*(c+h+4),p=l*(c+h+4);return function(){t.begin(),t.moveTo(o.x-f/2-p/2,o.y-p/2+f/2),t.lineTo(o.x+p/2-3*f/2,o.y-3*p/2-f/2),t.stroke()}};a.mxMarker.addMarker(Pe.ARROW_DASH,e)}}function ge(n,e,t,s){return Math.min(Math.max(n??s,e),t)}function Ln(n){return Math.max(n||0,0)}function Nn(n){const e=n??{};return e.debounceDelay=ge(e.debounceDelay,0,100,50),e.throttleDelay=ge(e.throttleDelay,0,100,50),e}function Ce(n){return n=="default"?void 0:ge(n,0,100,100)}function vn(n){return n=="default"?void 0:ge(n,1,50,1)}var _n=typeof global=="object"&&global&&global.Object===Object&&global;const yn=_n;var wn=typeof self=="object"&&self&&self.Object===Object&&self,Rn=yn||wn||Function("return this")();const gt=Rn;var bn=gt.Symbol;const fe=bn;var ft=Object.prototype,xn=ft.hasOwnProperty,Fn=ft.toString,Q=fe?fe.toStringTag:void 0;function Pn(n){var e=xn.call(n,Q),t=n[Q];try{n[Q]=void 0;var s=!0}catch{}var i=Fn.call(n);return s&&(e?n[Q]=t:delete n[Q]),i}var kn=Object.prototype,Mn=kn.toString;function Bn(n){return Mn.call(n)}var Gn="[object Null]",Vn="[object Undefined]",Je=fe?fe.toStringTag:void 0;function Yn(n){return n==null?n===void 0?Vn:Gn:Je&&Je in Object(n)?Pn(n):Bn(n)}function Un(n){return n!=null&&typeof n=="object"}var Wn="[object Symbol]";function Hn(n){return typeof n=="symbol"||Un(n)&&Yn(n)==Wn}var Kn=/\s/;function zn(n){for(var e=n.length;e--&&Kn.test(n.charAt(e)););return e}var Dn=/^\s+/;function Xn(n){return n&&n.slice(0,zn(n)+1).replace(Dn,"")}function Te(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var et=0/0,$n=/^[-+]0x[0-9a-f]+$/i,Zn=/^0b[01]+$/i,jn=/^0o[0-7]+$/i,qn=parseInt;function tt(n){if(typeof n=="number")return n;if(Hn(n))return et;if(Te(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=Te(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=Xn(n);var t=Zn.test(n);return t||jn.test(n)?qn(n.slice(2),t?2:8):$n.test(n)?et:+n}var Qn=function(){return gt.Date.now()};const Ne=Qn;var Jn="Expected a function",es=Math.max,ts=Math.min;function Tt(n,e,t){var s,i,o,r,l,c,u=0,h=!1,f=!1,p=!0;if(typeof n!="function")throw new TypeError(Jn);e=tt(e)||0,Te(t)&&(h=!!t.leading,f="maxWait"in t,o=f?es(tt(t.maxWait)||0,e):o,p="trailing"in t?!!t.trailing:p);function T(N){var M=s,q=i;return s=i=void 0,u=N,r=n.apply(q,M),r}function I(N){return u=N,l=setTimeout(le,e),h?T(N):r}function x(N){var M=N-c,q=N-u,De=e-M;return f?ts(De,o-q):De}function Y(N){var M=N-c,q=N-u;return c===void 0||M>=e||M<0||f&&q>=o}function le(){var N=Ne();if(Y(N))return ze(N);l=setTimeout(le,x(N))}function ze(N){return l=void 0,p&&s?T(N):(s=i=void 0,r)}function Bt(){l!==void 0&&clearTimeout(l),u=0,s=c=i=l=void 0}function Gt(){return l===void 0?r:ze(Ne())}function Ae(){var N=Ne(),M=Y(N);if(s=arguments,i=this,c=N,M){if(l===void 0)return I(c);if(f)return clearTimeout(l),l=setTimeout(le,e),T(c)}return l===void 0&&(l=setTimeout(le,e)),r}return Ae.cancel=Bt,Ae.flush=Gt,Ae}var ns="Expected a function";function ss(n,e,t){var s=!0,i=!0;if(typeof n!="function")throw new TypeError(ns);return Te(t)&&(s="leading"in t?!!t.leading:s,i="trailing"in t?!!t.trailing:i),Tt(n,e,{leading:s,maxWait:e,trailing:i})}const Re=1.25,is=1/Re;class os extends a.mxGraph{constructor(t){super(t);g(this,"currentZoomLevel",1);this.zoomFactor=Re,this.container&&(this.container.style.cursor="default")}createGraphView(){return new rs(this)}batchUpdate(t){this.model.beginUpdate();try{t()}finally{this.model.endUpdate()}}fit(t,s,i,o,r,l,c){const u=super.fit(t,s,i,o,r,l,c);return this.setCurrentZoomLevel(u),u}setCurrentZoomLevel(t){this.currentZoomLevel=t??this.view.scale}zoomActual(){super.zoomActual(),this.setCurrentZoomLevel()}zoomIn(){super.zoomIn(),this.setCurrentZoomLevel()}zoomOut(){super.zoomOut(),this.setCurrentZoomLevel()}customFit(t){this.zoomActual();const s=t==null?void 0:t.type;if(s==null||s==te.None)return;const i=Ln(t==null?void 0:t.margin);if(s!=te.Center){let o=!1,r=!1;switch(s){case te.Horizontal:r=!0;break;case te.Vertical:o=!0;break}this.fit(this.border,!1,i,!0,o,r)}else{const r=this.getGraphBounds(),l=this.container.clientWidth-i,c=this.container.clientHeight-i,u=r.width/this.view.scale,h=r.height/this.view.scale,f=Math.min(3,Math.min(l/u,c/h));this.setCurrentZoomLevel(f),this.view.scaleAndTranslate(f,(i+l-u*f)/(2*f)-r.x/this.view.scale,(i+c-h*f)/(2*f)-r.y/this.view.scale)}}registerMouseWheelZoomListeners(t){t=Nn(t),a.mxEvent.addMouseWheelListener(Tt(this.createMouseWheelZoomListener(!0),t.debounceDelay),this.container),a.mxEvent.addMouseWheelListener(ss(this.createMouseWheelZoomListener(!1),t.throttleDelay),this.container)}manageMouseWheelZoomEvent(t,s,i){if(!i)this.currentZoomLevel*=t?Re:is;else{const[o,r]=this.getEventRelativeCoordinates(s),[l,c,u]=this.getScaleAndTranslationDeltas(o,r);this.view.scaleAndTranslate(l,this.view.translate.x+c,this.view.translate.y+u),a.mxEvent.consume(s)}}createMouseWheelZoomListener(t){return(s,i)=>{if(a.mxEvent.isConsumed(s))return;const o=s;o.ctrlKey&&!o.altKey&&!o.shiftKey&&!o.metaKey&&this.manageMouseWheelZoomEvent(i,o,t)}}getEventRelativeCoordinates(t){const s=this.container.getBoundingClientRect(),i=t.clientX-s.left,o=t.clientY-s.top;return[i,o]}getScaleAndTranslationDeltas(t,s){const[i,o]=this.calculateFactorAndScale(),[r,l]=this.calculateTranslationDeltas(i,o,t*2,s*2);return[o,r,l]}calculateTranslationDeltas(t,s,i,o){if(t>1){const r=(t-1)/(s*2);i*=-r,o*=-r}else{const r=(1/t-1)/(this.view.scale*2);i*=r,o*=r}return[i,o]}calculateFactorAndScale(){const t=Math.round(this.currentZoomLevel*100)/100;return[t/this.view.scale,t]}}class rs extends a.mxGraphView{getFloatingTerminalPoint(e,t,s,i){if(e.absolutePoints.filter(Boolean).length<2)return super.getFloatingTerminalPoint(e,t,s,i);const l=e.absolutePoints;return i?l[1]:l[l.length-2]}}class as{constructor(e){g(this,"graph");this.container=e,this.graph=new os(e)}configure(e){return this.configureGraph(),this.configureNavigationSupport(e),new ut(this.graph).configureStyles(),new An().configureShapes(),new On().configureMarkers(),this.graph}configureGraph(){this.graph.setCellsLocked(!0),this.graph.setCellsSelectable(!1),this.graph.setEdgeLabelsMovable(!1),this.graph.setHtmlLabels(!0),this.graph.setConstrainChildren(!1),this.graph.setExtendParents(!1),this.graph.foldingEnabled=!1}configureNavigationSupport(e){var s;const t=this.graph.panningHandler;(s=e==null?void 0:e.navigation)!=null&&s.enabled?(t.addListener(a.mxEvent.PAN_START,this.getPanningHandler("grab")),t.addListener(a.mxEvent.PAN_END,this.getPanningHandler("default")),t.usePopupTrigger=!1,t.isForcePanningEvent=i=>a.mxEvent.isLeftMouseButton(i.getEvent())||a.mxEvent.isMultiTouchEvent(i.getEvent()),this.graph.setPanning(!0),this.graph.registerMouseWheelZoomListeners(e.navigation.zoom)):(this.graph.setPanning(!1),t.setPinchEnabled(!1),t.isForcePanningEvent=i=>!1)}getPanningHandler(e){return()=>{this.graph.isEnabled()&&(this.container.style.cursor=e)}}}class Se{constructor(e,t,s,i,o){this.id=e,this.name=t,this.kind=s,this.sourceRefId=i,this.targetRefId=o}}class pt extends Se{constructor(e,t,s,i,o=P.NORMAL){super(e,t,b.SEQUENCE_FLOW,s,i),this.sequenceFlowKind=o}}class Et extends Se{constructor(e,t,s,i){super(e,t,b.MESSAGE_FLOW,s,i)}}class mt extends Se{constructor(e,t,s,i,o=H.NONE){super(e,t,b.ASSOCIATION_FLOW,s,i),this.associationDirectionKind=o}}class ls{constructor(e){this.graph=e}computeRelativeCoordinates(e,t){const s=this.getTranslateForRoot(e),i=t.x+s.x,o=t.y+s.y;return new a.mxPoint(i,o)}getTranslateForRoot(e){const t=this.graph.getModel(),s=new a.mxPoint(0,0);for(;e!=null;){const i=t.getGeometry(e);i!=null&&(s.x-=i.x,s.y-=i.y),e=t.getParent(e)}return s}computeEdgeCenter(e){const t=e.geometry.points,s=t[0],i=t[t.length-1];if(s!=null&&i!=null){const o=i.x-s.x,r=i.y-s.y;return new a.mxPoint(s.x+o/2,s.y+r/2)}}}class de{constructor(e,t,s,i,o){g(this,"extensions",{});this.id=e,this.bpmnElement=t,this.bounds=s,this.label=i,this.isHorizontal=o}}class k{constructor(e,t,s,i,o=!1){g(this,"incomingIds",[]);g(this,"outgoingIds",[]);this.id=e,this.name=t,this.kind=s,this.parentId=i,this.instantiate=o}}class Ie extends k{constructor(e,t,s,i,o,r=[]){super(e,t,s,i,o),this.markers=r}}class ie extends Ie{constructor(e,t,s,i,o,r){super(e,t,d.CALL_ACTIVITY,i,void 0,o),this.callActivityKind=s,this.globalTaskKind=r}}class pe extends Ie{constructor(e,t,s,i,o){super(e,t,d.SUB_PROCESS,i,void 0,o),this.subProcessKind=s}}class oe extends k{constructor(e,t,s,i,o){super(e,t,s,o),this.eventDefinitionKind=i}}class Ct extends oe{constructor(e,t,s,i,o){super(e,t,d.EVENT_START,s,i),this.isInterrupting=o}}class St extends oe{constructor(e,t,s,i,o=!0){super(e,t,d.EVENT_BOUNDARY,s,i),this.isInterrupting=o}}class It extends k{constructor(e,t,s,i,o=se.None){super(e,t,d.GATEWAY_EVENT_BASED,s,i),this.gatewayKind=o}}class K{constructor(e){g(this,"ignoreBpmnColors");this.ignoreBpmnColors=(e==null?void 0:e.ignoreBpmnColors)??!0}computeStyle(e,t){const s=[e.bpmnElement.kind];let i;e instanceof de?i=this.computeShapeStyleValues(e):(s.push(...K.computeEdgeBaseStyles(e)),i=this.computeEdgeStyleValues(e));const o=this.computeFontStyleValues(e),r=K.computeLabelStyleValues(e,t);return s.concat(nt([...i,...o,...r])).join(";")}computeShapeStyleValues(e){const t=new Map,s=e.bpmnElement;if(s instanceof oe?K.computeEventShapeStyle(s,t):s instanceof Ie?K.computeActivityShapeStyle(s,t):S.isPoolOrLane(s.kind)?t.set(a.mxConstants.STYLE_HORIZONTAL,e.isHorizontal?"0":"1"):s instanceof It&&(t.set(m.IS_INSTANTIATING,String(s.instantiate)),t.set(m.EVENT_BASED_GATEWAY_KIND,String(s.gatewayKind))),!this.ignoreBpmnColors){const i=e.extensions,o=i.fillColor;o&&(t.set(a.mxConstants.STYLE_FILLCOLOR,o),S.isPoolOrLane(s.kind)&&t.set(a.mxConstants.STYLE_SWIMLANE_FILLCOLOR,o)),i.strokeColor&&t.set(a.mxConstants.STYLE_STROKECOLOR,i.strokeColor)}return t}static computeEventShapeStyle(e,t){t.set(m.EVENT_DEFINITION_KIND,e.eventDefinitionKind),(e instanceof St||e instanceof Ct&&e.isInterrupting!==void 0)&&t.set(m.IS_INTERRUPTING,String(e.isInterrupting))}static computeActivityShapeStyle(e,t){e instanceof pe?t.set(m.SUB_PROCESS_KIND,e.subProcessKind):e.kind===d.TASK_RECEIVE?t.set(m.IS_INSTANTIATING,String(e.instantiate)):e instanceof ie&&t.set(m.GLOBAL_TASK_KIND,e.globalTaskKind);const s=e.markers;s.length>0&&t.set(m.MARKERS,s.join(","))}static computeEdgeBaseStyles(e){const t=[],s=e.bpmnElement;return s instanceof pt&&t.push(s.sequenceFlowKind),s instanceof mt&&t.push(s.associationDirectionKind),t}computeEdgeStyleValues(e){const t=new Map;if(!this.ignoreBpmnColors){const s=e.extensions;s.strokeColor&&t.set(a.mxConstants.STYLE_STROKECOLOR,s.strokeColor)}return t}computeFontStyleValues(e){var i,o;const t=new Map,s=(i=e.label)==null?void 0:i.font;if(s&&(t.set(a.mxConstants.STYLE_FONTFAMILY,s.name),t.set(a.mxConstants.STYLE_FONTSIZE,s.size),t.set(a.mxConstants.STYLE_FONTSTYLE,cs(s))),!this.ignoreBpmnColors){const r=(o=e.label)==null?void 0:o.extensions;r!=null&&r.color&&t.set(a.mxConstants.STYLE_FONTCOLOR,r.color)}return t}static computeLabelStyleValues(e,t){const s=new Map,i=e.bpmnElement;return t?(s.set(a.mxConstants.STYLE_VERTICAL_ALIGN,a.mxConstants.ALIGN_TOP),e.bpmnElement.kind!=d.TEXT_ANNOTATION&&s.set(a.mxConstants.STYLE_ALIGN,a.mxConstants.ALIGN_CENTER),e instanceof de&&(s.set(a.mxConstants.STYLE_LABEL_WIDTH,t.width+1),s.set(a.mxConstants.STYLE_LABEL_POSITION,"ignore"),s.set(a.mxConstants.STYLE_VERTICAL_LABEL_POSITION,a.mxConstants.ALIGN_MIDDLE))):e instanceof de&&(i instanceof pe||i instanceof ie&&i.callActivityKind===ne.CALLING_PROCESS)&&!i.markers.includes(v.EXPAND)&&s.set(a.mxConstants.STYLE_VERTICAL_ALIGN,a.mxConstants.ALIGN_TOP),s}computeMessageFlowIconStyle(e){const t=[];return t.push(["shape",m.MESSAGE_FLOW_ICON]),t.push([m.IS_INITIATING,String(e.messageVisibleKind===re.INITIATING)]),this.ignoreBpmnColors||e.extensions.strokeColor&&t.push([a.mxConstants.STYLE_STROKECOLOR,e.extensions.strokeColor]),nt(t).join(";")}}function cs(n){let e=0;return n.isBold&&(e+=a.mxConstants.FONT_BOLD),n.isItalic&&(e+=a.mxConstants.FONT_ITALIC),n.isStrikeThrough&&(e+=a.mxConstants.FONT_STRIKETHROUGH),n.isUnderline&&(e+=a.mxConstants.FONT_UNDERLINE),e}function nt(n){return n.filter(([,e])=>e&&e!="undefined").map(([e,t])=>`${e}=${t}`)}class us{constructor(e,t,s){this.graph=e,this.coordinatesTranslator=t,this.styleComputer=s}render(e,t){this.insertShapesAndEdges(e),this.graph.customFit(t)}insertShapesAndEdges({pools:e,lanes:t,subprocesses:s,otherFlowNodes:i,boundaryEvents:o,edges:r}){this.graph.batchUpdate(()=>{this.graph.getModel().clear(),this.insertShapes(e),this.insertShapes(t),this.insertShapes(s),this.insertShapes(i),this.insertShapes(o),this.insertEdges(r)})}insertShapes(e){e.forEach(t=>this.insertShape(t))}getParent(e){return this.getCell(e.parentId)??this.graph.getDefaultParent()}insertShape(e){var l;const t=e.bpmnElement,s=this.getParent(t),i=e.bounds;let o=(l=e.label)==null?void 0:l.bounds;o=S.isPoolOrLane(t.kind)?void 0:o;const r=this.styleComputer.computeStyle(e,o);this.insertVertex(s,t.id,t.name,i,o,r)}insertEdges(e){e.forEach(t=>{var h;const s=t.bpmnElement,i=this.graph.getDefaultParent(),o=this.getCell(s.sourceRefId),r=this.getCell(s.targetRefId),l=(h=t.label)==null?void 0:h.bounds,c=this.styleComputer.computeStyle(t,l),u=this.graph.insertEdge(i,s.id,s.name,o,r,c);if(this.insertWaypoints(t.waypoints,u),l){u.geometry.width=l.width,u.geometry.height=l.height;const f=this.coordinatesTranslator.computeEdgeCenter(u);if(f){u.geometry.relative=!1;const p=this.coordinatesTranslator.computeRelativeCoordinates(u.parent,new a.mxPoint(l.x,l.y)),T=p.x+l.width/2-f.x,I=p.y-f.y;u.geometry.offset=new a.mxPoint(T,I)}}this.insertMessageFlowIconIfNeeded(t,u)})}insertMessageFlowIconIfNeeded(e,t){if(e.bpmnElement instanceof Et&&e.messageVisibleKind!==re.NONE){const s=this.graph.insertVertex(t,At(t.id),void 0,0,0,20,14,this.styleComputer.computeMessageFlowIconStyle(e));s.geometry.relative=!0,s.geometry.offset=new a.mxPoint(-10,-7)}}insertWaypoints(e,t){e&&(t.geometry.points=e.map(s=>this.coordinatesTranslator.computeRelativeCoordinates(t.parent,new a.mxPoint(s.x,s.y))))}getCell(e){return this.graph.getModel().getCell(e)}insertVertex(e,t,s,i,o,r){const l=this.coordinatesTranslator.computeRelativeCoordinates(e,new a.mxPoint(i.x,i.y)),c=this.graph.insertVertex(e,t,s,l.x,l.y,i.width,i.height,r);if(o){const u=o.x-i.x,h=o.y-i.y;c.geometry.offset=new a.mxPoint(u,h)}return c}}function ds(n,e){return new us(n,new ls(n),new K(e))}function At(n){return`messageFlowIcon_of_${n}`}var Me={},Be={};(function(n){const e=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",t=e+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",s="["+e+"]["+t+"]*",i=new RegExp("^"+s+"$"),o=function(l,c){const u=[];let h=c.exec(l);for(;h;){const f=[];f.startIndex=c.lastIndex-h[0].length;const p=h.length;for(let T=0;T<p;T++)f.push(h[T]);u.push(f),h=c.exec(l)}return u},r=function(l){const c=i.exec(l);return!(c===null||typeof c>"u")};n.isExist=function(l){return typeof l<"u"},n.isEmptyObject=function(l){return Object.keys(l).length===0},n.merge=function(l,c,u){if(c){const h=Object.keys(c),f=h.length;for(let p=0;p<f;p++)u==="strict"?l[h[p]]=[c[h[p]]]:l[h[p]]=c[h[p]]}},n.getValue=function(l){return n.isExist(l)?l:""},n.isName=r,n.getAllMatches=o,n.nameRegexp=s})(Be);const Ge=Be,hs={allowBooleanAttributes:!1,unpairedTags:[]};Me.validate=function(n,e){e=Object.assign({},hs,e);const t=[];let s=!1,i=!1;n[0]==="\uFEFF"&&(n=n.substr(1));for(let o=0;o<n.length;o++)if(n[o]==="<"&&n[o+1]==="?"){if(o+=2,o=it(n,o),o.err)return o}else if(n[o]==="<"){let r=o;if(o++,n[o]==="!"){o=ot(n,o);continue}else{let l=!1;n[o]==="/"&&(l=!0,o++);let c="";for(;o<n.length&&n[o]!==">"&&n[o]!==" "&&n[o]!=="	"&&n[o]!==`
`&&n[o]!=="\r";o++)c+=n[o];if(c=c.trim(),c[c.length-1]==="/"&&(c=c.substring(0,c.length-1),o--),!Ss(c)){let f;return c.trim().length===0?f="Invalid space after '<'.":f="Tag '"+c+"' is an invalid name.",L("InvalidTag",f,y(n,o))}const u=Ts(n,o);if(u===!1)return L("InvalidAttr","Attributes for '"+c+"' have open quote.",y(n,o));let h=u.value;if(o=u.index,h[h.length-1]==="/"){const f=o-h.length;h=h.substring(0,h.length-1);const p=rt(h,e);if(p===!0)s=!0;else return L(p.err.code,p.err.msg,y(n,f+p.err.line))}else if(l)if(u.tagClosed){if(h.trim().length>0)return L("InvalidTag","Closing tag '"+c+"' can't have attributes or invalid starting.",y(n,r));{const f=t.pop();if(c!==f.tagName){let p=y(n,f.tagStartPos);return L("InvalidTag","Expected closing tag '"+f.tagName+"' (opened in line "+p.line+", col "+p.col+") instead of closing tag '"+c+"'.",y(n,r))}t.length==0&&(i=!0)}}else return L("InvalidTag","Closing tag '"+c+"' doesn't have proper closing.",y(n,o));else{const f=rt(h,e);if(f!==!0)return L(f.err.code,f.err.msg,y(n,o-h.length+f.err.line));if(i===!0)return L("InvalidXml","Multiple possible root nodes found.",y(n,o));e.unpairedTags.indexOf(c)!==-1||t.push({tagName:c,tagStartPos:r}),s=!0}for(o++;o<n.length;o++)if(n[o]==="<")if(n[o+1]==="!"){o++,o=ot(n,o);continue}else if(n[o+1]==="?"){if(o=it(n,++o),o.err)return o}else break;else if(n[o]==="&"){const f=ms(n,o);if(f==-1)return L("InvalidChar","char '&' is not expected.",y(n,o));o=f}else if(i===!0&&!st(n[o]))return L("InvalidXml","Extra text at the end",y(n,o));n[o]==="<"&&o--}}else{if(st(n[o]))continue;return L("InvalidChar","char '"+n[o]+"' is not expected.",y(n,o))}if(s){if(t.length==1)return L("InvalidTag","Unclosed tag '"+t[0].tagName+"'.",y(n,t[0].tagStartPos));if(t.length>0)return L("InvalidXml","Invalid '"+JSON.stringify(t.map(o=>o.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return L("InvalidXml","Start tag expected.",1);return!0};function st(n){return n===" "||n==="	"||n===`
`||n==="\r"}function it(n,e){const t=e;for(;e<n.length;e++)if(n[e]=="?"||n[e]==" "){const s=n.substr(t,e-t);if(e>5&&s==="xml")return L("InvalidXml","XML declaration allowed only at the start of the document.",y(n,e));if(n[e]=="?"&&n[e+1]==">"){e++;break}else continue}return e}function ot(n,e){if(n.length>e+5&&n[e+1]==="-"&&n[e+2]==="-"){for(e+=3;e<n.length;e++)if(n[e]==="-"&&n[e+1]==="-"&&n[e+2]===">"){e+=2;break}}else if(n.length>e+8&&n[e+1]==="D"&&n[e+2]==="O"&&n[e+3]==="C"&&n[e+4]==="T"&&n[e+5]==="Y"&&n[e+6]==="P"&&n[e+7]==="E"){let t=1;for(e+=8;e<n.length;e++)if(n[e]==="<")t++;else if(n[e]===">"&&(t--,t===0))break}else if(n.length>e+9&&n[e+1]==="["&&n[e+2]==="C"&&n[e+3]==="D"&&n[e+4]==="A"&&n[e+5]==="T"&&n[e+6]==="A"&&n[e+7]==="["){for(e+=8;e<n.length;e++)if(n[e]==="]"&&n[e+1]==="]"&&n[e+2]===">"){e+=2;break}}return e}const gs='"',fs="'";function Ts(n,e){let t="",s="",i=!1;for(;e<n.length;e++){if(n[e]===gs||n[e]===fs)s===""?s=n[e]:s!==n[e]||(s="");else if(n[e]===">"&&s===""){i=!0;break}t+=n[e]}return s!==""?!1:{value:t,index:e,tagClosed:i}}const ps=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function rt(n,e){const t=Ge.getAllMatches(n,ps),s={};for(let i=0;i<t.length;i++){if(t[i][1].length===0)return L("InvalidAttr","Attribute '"+t[i][2]+"' has no space in starting.",J(t[i]));if(t[i][3]!==void 0&&t[i][4]===void 0)return L("InvalidAttr","Attribute '"+t[i][2]+"' is without value.",J(t[i]));if(t[i][3]===void 0&&!e.allowBooleanAttributes)return L("InvalidAttr","boolean attribute '"+t[i][2]+"' is not allowed.",J(t[i]));const o=t[i][2];if(!Cs(o))return L("InvalidAttr","Attribute '"+o+"' is an invalid name.",J(t[i]));if(!s.hasOwnProperty(o))s[o]=1;else return L("InvalidAttr","Attribute '"+o+"' is repeated.",J(t[i]))}return!0}function Es(n,e){let t=/\d/;for(n[e]==="x"&&(e++,t=/[\da-fA-F]/);e<n.length;e++){if(n[e]===";")return e;if(!n[e].match(t))break}return-1}function ms(n,e){if(e++,n[e]===";")return-1;if(n[e]==="#")return e++,Es(n,e);let t=0;for(;e<n.length;e++,t++)if(!(n[e].match(/\w/)&&t<20)){if(n[e]===";")break;return-1}return e}function L(n,e,t){return{err:{code:n,msg:e,line:t.line||t,col:t.col}}}function Cs(n){return Ge.isName(n)}function Ss(n){return Ge.isName(n)}function y(n,e){const t=n.substring(0,e).split(/\r?\n/);return{line:t.length,col:t[t.length-1].length+1}}function J(n){return n.startIndex+n[1].length}var Ve={};const Ot={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(n,e){return e},attributeValueProcessor:function(n,e){return e},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(n,e,t){return n}},Is=function(n){return Object.assign({},Ot,n)};Ve.buildOptions=Is;Ve.defaultOptions=Ot;class As{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,t){e==="__proto__"&&(e="#__proto__"),this.child.push({[e]:t})}addChild(e){e.tagname==="__proto__"&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,[":@"]:e[":@"]}):this.child.push({[e.tagname]:e.child})}}var Os=As;function Ls(n,e){const t={};if(n[e+3]==="O"&&n[e+4]==="C"&&n[e+5]==="T"&&n[e+6]==="Y"&&n[e+7]==="P"&&n[e+8]==="E"){e=e+9;let s=1,i=!1,o=!1,r="";for(;e<n.length;e++)if(n[e]==="<"&&!o){if(i&&_s(n,e))e+=7,[entityName,val,e]=Ns(n,e+1),val.indexOf("&")===-1&&(t[entityName]={regx:RegExp(`&${entityName};`,"g"),val});else if(i&&ys(n,e))e+=8;else if(i&&ws(n,e))e+=8;else if(i&&Rs(n,e))e+=9;else if(vs)o=!0;else throw new Error("Invalid DOCTYPE");s++,r=""}else if(n[e]===">"){if(o?n[e-1]==="-"&&n[e-2]==="-"&&(o=!1,s--):s--,s===0)break}else n[e]==="["?i=!0:r+=n[e];if(s!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:t,i:e}}function Ns(n,e){let t="";for(;e<n.length&&n[e]!=="'"&&n[e]!=='"';e++)t+=n[e];if(t=t.trim(),t.indexOf(" ")!==-1)throw new Error("External entites are not supported");const s=n[e++];let i="";for(;e<n.length&&n[e]!==s;e++)i+=n[e];return[t,i,e]}function vs(n,e){return n[e+1]==="!"&&n[e+2]==="-"&&n[e+3]==="-"}function _s(n,e){return n[e+1]==="!"&&n[e+2]==="E"&&n[e+3]==="N"&&n[e+4]==="T"&&n[e+5]==="I"&&n[e+6]==="T"&&n[e+7]==="Y"}function ys(n,e){return n[e+1]==="!"&&n[e+2]==="E"&&n[e+3]==="L"&&n[e+4]==="E"&&n[e+5]==="M"&&n[e+6]==="E"&&n[e+7]==="N"&&n[e+8]==="T"}function ws(n,e){return n[e+1]==="!"&&n[e+2]==="A"&&n[e+3]==="T"&&n[e+4]==="T"&&n[e+5]==="L"&&n[e+6]==="I"&&n[e+7]==="S"&&n[e+8]==="T"}function Rs(n,e){return n[e+1]==="!"&&n[e+2]==="N"&&n[e+3]==="O"&&n[e+4]==="T"&&n[e+5]==="A"&&n[e+6]==="T"&&n[e+7]==="I"&&n[e+8]==="O"&&n[e+9]==="N"}var bs=Ls;const xs=/^[-+]?0x[a-fA-F0-9]+$/,Fs=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const Ps={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function ks(n,e={}){if(e=Object.assign({},Ps,e),!n||typeof n!="string")return n;let t=n.trim();if(e.skipLike!==void 0&&e.skipLike.test(t))return n;if(e.hex&&xs.test(t))return Number.parseInt(t,16);{const s=Fs.exec(t);if(s){const i=s[1],o=s[2];let r=Ms(s[3]);const l=s[4]||s[6];if(!e.leadingZeros&&o.length>0&&i&&t[2]!==".")return n;if(!e.leadingZeros&&o.length>0&&!i&&t[1]!==".")return n;{const c=Number(t),u=""+c;return u.search(/[eE]/)!==-1||l?e.eNotation?c:n:t.indexOf(".")!==-1?u==="0"&&r===""||u===r||i&&u==="-"+r?c:n:o?r===u||i+r===u?c:n:t===u||t===i+u?c:n}}else return n}}function Ms(n){return n&&n.indexOf(".")!==-1&&(n=n.replace(/0+$/,""),n==="."?n="0":n[0]==="."?n="0"+n:n[n.length-1]==="."&&(n=n.substr(0,n.length-1))),n}var Bs=ks;const Ye=Be,ee=Os,Gs=bs,Vs=Bs;"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,Ye.nameRegexp);let Ys=class{constructor(e){this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:""},pound:{regex:/&(pound|#163);/g,val:""},yen:{regex:/&(yen|#165);/g,val:""},euro:{regex:/&(euro|#8364);/g,val:""},copyright:{regex:/&(copy|#169);/g,val:""},reg:{regex:/&(reg|#174);/g,val:""},inr:{regex:/&(inr|#8377);/g,val:""}},this.addExternalEntities=Us,this.parseXml=Ds,this.parseTextData=Ws,this.resolveNameSpace=Hs,this.buildAttributesMap=zs,this.isItStopNode=js,this.replaceEntitiesValue=$s,this.readStopNodeData=Qs,this.saveTextToParentTag=Zs,this.addChild=Xs}};function Us(n){const e=Object.keys(n);for(let t=0;t<e.length;t++){const s=e[t];this.lastEntities[s]={regex:new RegExp("&"+s+";","g"),val:n[s]}}}function Ws(n,e,t,s,i,o,r){if(n!==void 0&&(this.options.trimValues&&!s&&(n=n.trim()),n.length>0)){r||(n=this.replaceEntitiesValue(n));const l=this.options.tagValueProcessor(e,n,t,i,o);return l==null?n:typeof l!=typeof n||l!==n?l:this.options.trimValues?xe(n,this.options.parseTagValue,this.options.numberParseOptions):n.trim()===n?xe(n,this.options.parseTagValue,this.options.numberParseOptions):n}}function Hs(n){if(this.options.removeNSPrefix){const e=n.split(":"),t=n.charAt(0)==="/"?"/":"";if(e[0]==="xmlns")return"";e.length===2&&(n=t+e[1])}return n}const Ks=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function zs(n,e,t){if(!this.options.ignoreAttributes&&typeof n=="string"){const s=Ye.getAllMatches(n,Ks),i=s.length,o={};for(let r=0;r<i;r++){const l=this.resolveNameSpace(s[r][1]);let c=s[r][4],u=this.options.attributeNamePrefix+l;if(l.length)if(this.options.transformAttributeName&&(u=this.options.transformAttributeName(u)),u==="__proto__"&&(u="#__proto__"),c!==void 0){this.options.trimValues&&(c=c.trim()),c=this.replaceEntitiesValue(c);const h=this.options.attributeValueProcessor(l,c,e);h==null?o[u]=c:typeof h!=typeof c||h!==c?o[u]=h:o[u]=xe(c,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(o[u]=!0)}if(!Object.keys(o).length)return;if(this.options.attributesGroupName){const r={};return r[this.options.attributesGroupName]=o,r}return o}}const Ds=function(n){n=n.replace(/\r\n?/g,`
`);const e=new ee("!xml");let t=e,s="",i="";for(let o=0;o<n.length;o++)if(n[o]==="<")if(n[o+1]==="/"){const l=W(n,">",o,"Closing Tag is not closed.");let c=n.substring(o+2,l).trim();if(this.options.removeNSPrefix){const f=c.indexOf(":");f!==-1&&(c=c.substr(f+1))}this.options.transformTagName&&(c=this.options.transformTagName(c)),t&&(s=this.saveTextToParentTag(s,t,i));const u=i.substring(i.lastIndexOf(".")+1);if(c&&this.options.unpairedTags.indexOf(c)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${c}>`);let h=0;u&&this.options.unpairedTags.indexOf(u)!==-1?(h=i.lastIndexOf(".",i.lastIndexOf(".")-1),this.tagsNodeStack.pop()):h=i.lastIndexOf("."),i=i.substring(0,h),t=this.tagsNodeStack.pop(),s="",o=l}else if(n[o+1]==="?"){let l=be(n,o,!1,"?>");if(!l)throw new Error("Pi Tag is not closed.");if(s=this.saveTextToParentTag(s,t,i),!(this.options.ignoreDeclaration&&l.tagName==="?xml"||this.options.ignorePiTags)){const c=new ee(l.tagName);c.add(this.options.textNodeName,""),l.tagName!==l.tagExp&&l.attrExpPresent&&(c[":@"]=this.buildAttributesMap(l.tagExp,i,l.tagName)),this.addChild(t,c,i)}o=l.closeIndex+1}else if(n.substr(o+1,3)==="!--"){const l=W(n,"-->",o+4,"Comment is not closed.");if(this.options.commentPropName){const c=n.substring(o+4,l-2);s=this.saveTextToParentTag(s,t,i),t.add(this.options.commentPropName,[{[this.options.textNodeName]:c}])}o=l}else if(n.substr(o+1,2)==="!D"){const l=Gs(n,o);this.docTypeEntities=l.entities,o=l.i}else if(n.substr(o+1,2)==="!["){const l=W(n,"]]>",o,"CDATA is not closed.")-2,c=n.substring(o+9,l);if(s=this.saveTextToParentTag(s,t,i),this.options.cdataPropName)t.add(this.options.cdataPropName,[{[this.options.textNodeName]:c}]);else{let u=this.parseTextData(c,t.tagname,i,!0,!1,!0);u==null&&(u=""),t.add(this.options.textNodeName,u)}o=l+2}else{let l=be(n,o,this.options.removeNSPrefix),c=l.tagName,u=l.tagExp,h=l.attrExpPresent,f=l.closeIndex;this.options.transformTagName&&(c=this.options.transformTagName(c)),t&&s&&t.tagname!=="!xml"&&(s=this.saveTextToParentTag(s,t,i,!1));const p=t;if(p&&this.options.unpairedTags.indexOf(p.tagname)!==-1&&(t=this.tagsNodeStack.pop(),i=i.substring(0,i.lastIndexOf("."))),c!==e.tagname&&(i+=i?"."+c:c),this.isItStopNode(this.options.stopNodes,i,c)){let T="";if(u.length>0&&u.lastIndexOf("/")===u.length-1)o=l.closeIndex;else if(this.options.unpairedTags.indexOf(c)!==-1)o=l.closeIndex;else{const x=this.readStopNodeData(n,c,f+1);if(!x)throw new Error(`Unexpected end of ${c}`);o=x.i,T=x.tagContent}const I=new ee(c);c!==u&&h&&(I[":@"]=this.buildAttributesMap(u,i,c)),T&&(T=this.parseTextData(T,c,i,!0,h,!0,!0)),i=i.substr(0,i.lastIndexOf(".")),I.add(this.options.textNodeName,T),this.addChild(t,I,i)}else{if(u.length>0&&u.lastIndexOf("/")===u.length-1){c[c.length-1]==="/"?(c=c.substr(0,c.length-1),u=c):u=u.substr(0,u.length-1),this.options.transformTagName&&(c=this.options.transformTagName(c));const T=new ee(c);c!==u&&h&&(T[":@"]=this.buildAttributesMap(u,i,c)),this.addChild(t,T,i),i=i.substr(0,i.lastIndexOf("."))}else{const T=new ee(c);this.tagsNodeStack.push(t),c!==u&&h&&(T[":@"]=this.buildAttributesMap(u,i,c)),this.addChild(t,T,i),t=T}s="",o=f}}else s+=n[o];return e.child};function Xs(n,e,t){const s=this.options.updateTag(e.tagname,t,e[":@"]);s===!1||(typeof s=="string"&&(e.tagname=s),n.addChild(e))}const $s=function(n){if(this.options.processEntities){for(let e in this.docTypeEntities){const t=this.docTypeEntities[e];n=n.replace(t.regx,t.val)}for(let e in this.lastEntities){const t=this.lastEntities[e];n=n.replace(t.regex,t.val)}if(this.options.htmlEntities)for(let e in this.htmlEntities){const t=this.htmlEntities[e];n=n.replace(t.regex,t.val)}n=n.replace(this.ampEntity.regex,this.ampEntity.val)}return n};function Zs(n,e,t,s){return n&&(s===void 0&&(s=Object.keys(e.child).length===0),n=this.parseTextData(n,e.tagname,t,!1,e[":@"]?Object.keys(e[":@"]).length!==0:!1,s),n!==void 0&&n!==""&&e.add(this.options.textNodeName,n),n=""),n}function js(n,e,t){const s="*."+t;for(const i in n){const o=n[i];if(s===o||e===o)return!0}return!1}function qs(n,e,t=">"){let s,i="";for(let o=e;o<n.length;o++){let r=n[o];if(s)r===s&&(s="");else if(r==='"'||r==="'")s=r;else if(r===t[0])if(t[1]){if(n[o+1]===t[1])return{data:i,index:o}}else return{data:i,index:o};else r==="	"&&(r=" ");i+=r}}function W(n,e,t,s){const i=n.indexOf(e,t);if(i===-1)throw new Error(s);return i+e.length-1}function be(n,e,t,s=">"){const i=qs(n,e+1,s);if(!i)return;let o=i.data;const r=i.index,l=o.search(/\s/);let c=o,u=!0;if(l!==-1&&(c=o.substr(0,l).replace(/\s\s*$/,""),o=o.substr(l+1)),t){const h=c.indexOf(":");h!==-1&&(c=c.substr(h+1),u=c!==i.data.substr(h+1))}return{tagName:c,tagExp:o,closeIndex:r,attrExpPresent:u}}function Qs(n,e,t){const s=t;let i=1;for(;t<n.length;t++)if(n[t]==="<")if(n[t+1]==="/"){const o=W(n,">",t,`${e} is not closed`);if(n.substring(t+2,o).trim()===e&&(i--,i===0))return{tagContent:n.substring(s,t),i:o};t=o}else if(n[t+1]==="?")t=W(n,"?>",t+1,"StopNode is not closed.");else if(n.substr(t+1,3)==="!--")t=W(n,"-->",t+3,"StopNode is not closed.");else if(n.substr(t+1,2)==="![")t=W(n,"]]>",t,"StopNode is not closed.")-2;else{const o=be(n,t,">");o&&((o&&o.tagName)===e&&o.tagExp[o.tagExp.length-1]!=="/"&&i++,t=o.closeIndex)}}function xe(n,e,t){if(e&&typeof n=="string"){const s=n.trim();return s==="true"?!0:s==="false"?!1:Vs(n,t)}else return Ye.isExist(n)?n:""}var Js=Ys,Lt={};function ei(n,e){return Nt(n,e)}function Nt(n,e,t){let s;const i={};for(let o=0;o<n.length;o++){const r=n[o],l=ti(r);let c="";if(t===void 0?c=l:c=t+"."+l,l===e.textNodeName)s===void 0?s=r[l]:s+=""+r[l];else{if(l===void 0)continue;if(r[l]){let u=Nt(r[l],e,c);const h=si(u,e);r[":@"]?ni(u,r[":@"],c,e):Object.keys(u).length===1&&u[e.textNodeName]!==void 0&&!e.alwaysCreateTextNode?u=u[e.textNodeName]:Object.keys(u).length===0&&(e.alwaysCreateTextNode?u[e.textNodeName]="":u=""),i[l]!==void 0&&i.hasOwnProperty(l)?(Array.isArray(i[l])||(i[l]=[i[l]]),i[l].push(u)):e.isArray(l,c,h)?i[l]=[u]:i[l]=u}}}return typeof s=="string"?s.length>0&&(i[e.textNodeName]=s):s!==void 0&&(i[e.textNodeName]=s),i}function ti(n){const e=Object.keys(n);for(let t=0;t<e.length;t++){const s=e[t];if(s!==":@")return s}}function ni(n,e,t,s){if(e){const i=Object.keys(e),o=i.length;for(let r=0;r<o;r++){const l=i[r];s.isArray(l,t+"."+l,!0,!0)?n[l]=[e[l]]:n[l]=e[l]}}}function si(n,e){const{textNodeName:t}=e,s=Object.keys(n).length;return!!(s===0||s===1&&(n[t]||typeof n[t]=="boolean"||n[t]===0))}Lt.prettify=ei;const{buildOptions:ii}=Ve,oi=Js,{prettify:ri}=Lt,ai=Me;let li=class{constructor(e){this.externalEntities={},this.options=ii(e)}parse(e,t){if(typeof e!="string")if(e.toString)e=e.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(t){t===!0&&(t={});const o=ai.validate(e,t);if(o!==!0)throw Error(`${o.err.msg}:${o.err.line}:${o.err.col}`)}const s=new oi(this.options);s.addExternalEntities(this.externalEntities);const i=s.parseXml(e);return this.options.preserveOrder||i===void 0?i:ri(i,this.options)}addEntity(e,t){if(t.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(e.indexOf("&")!==-1||e.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(t==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=t}};var ci=li;const ui=`
`;function di(n,e){let t="";return e.format&&e.indentBy.length>0&&(t=ui),vt(n,e,"",t)}function vt(n,e,t,s){let i="",o=!1;for(let r=0;r<n.length;r++){const l=n[r],c=hi(l);let u="";if(t.length===0?u=c:u=`${t}.${c}`,c===e.textNodeName){let I=l[c];gi(u,e)||(I=e.tagValueProcessor(c,I),I=_t(I,e)),o&&(i+=s),i+=I,o=!1;continue}else if(c===e.cdataPropName){o&&(i+=s),i+=`<![CDATA[${l[c][0][e.textNodeName]}]]>`,o=!1;continue}else if(c===e.commentPropName){i+=s+`<!--${l[c][0][e.textNodeName]}-->`,o=!0;continue}else if(c[0]==="?"){const I=at(l[":@"],e),x=c==="?xml"?"":s;let Y=l[c][0][e.textNodeName];Y=Y.length!==0?" "+Y:"",i+=x+`<${c}${Y}${I}?>`,o=!0;continue}let h=s;h!==""&&(h+=e.indentBy);const f=at(l[":@"],e),p=s+`<${c}${f}`,T=vt(l[c],e,u,h);e.unpairedTags.indexOf(c)!==-1?e.suppressUnpairedNode?i+=p+">":i+=p+"/>":(!T||T.length===0)&&e.suppressEmptyNode?i+=p+"/>":T&&T.endsWith(">")?i+=p+`>${T}${s}</${c}>`:(i+=p+">",T&&s!==""&&(T.includes("/>")||T.includes("</"))?i+=s+e.indentBy+T+s:i+=T,i+=`</${c}>`),o=!0}return i}function hi(n){const e=Object.keys(n);for(let t=0;t<e.length;t++){const s=e[t];if(s!==":@")return s}}function at(n,e){let t="";if(n&&!e.ignoreAttributes)for(let s in n){let i=e.attributeValueProcessor(s,n[s]);i=_t(i,e),i===!0&&e.suppressBooleanAttributes?t+=` ${s.substr(e.attributeNamePrefix.length)}`:t+=` ${s.substr(e.attributeNamePrefix.length)}="${i}"`}return t}function gi(n,e){n=n.substr(0,n.length-e.textNodeName.length-1);let t=n.substr(n.lastIndexOf(".")+1);for(let s in e.stopNodes)if(e.stopNodes[s]===n||e.stopNodes[s]==="*."+t)return!0;return!1}function _t(n,e){if(n&&n.length>0&&e.processEntities)for(let t=0;t<e.entities.length;t++){const s=e.entities[t];n=n.replace(s.regex,s.val)}return n}var fi=di;const Ti=fi,pi={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(n,e){return e},attributeValueProcessor:function(n,e){return e},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function V(n){this.options=Object.assign({},pi,n),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=Ci),this.processTextOrObjNode=Ei,this.options.format?(this.indentate=mi,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}V.prototype.build=function(n){return this.options.preserveOrder?Ti(n,this.options):(Array.isArray(n)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(n={[this.options.arrayNodeName]:n}),this.j2x(n,0).val)};V.prototype.j2x=function(n,e){let t="",s="";for(let i in n)if(!(typeof n[i]>"u"))if(n[i]===null)i[0]==="?"?s+=this.indentate(e)+"<"+i+"?"+this.tagEndChar:s+=this.indentate(e)+"<"+i+"/"+this.tagEndChar;else if(n[i]instanceof Date)s+=this.buildTextValNode(n[i],i,"",e);else if(typeof n[i]!="object"){const o=this.isAttribute(i);if(o)t+=this.buildAttrPairStr(o,""+n[i]);else if(i===this.options.textNodeName){let r=this.options.tagValueProcessor(i,""+n[i]);s+=this.replaceEntitiesValue(r)}else s+=this.buildTextValNode(n[i],i,"",e)}else if(Array.isArray(n[i])){const o=n[i].length;let r="";for(let l=0;l<o;l++){const c=n[i][l];typeof c>"u"||(c===null?i[0]==="?"?s+=this.indentate(e)+"<"+i+"?"+this.tagEndChar:s+=this.indentate(e)+"<"+i+"/"+this.tagEndChar:typeof c=="object"?this.options.oneListGroup?r+=this.j2x(c,e+1).val:r+=this.processTextOrObjNode(c,i,e):r+=this.buildTextValNode(c,i,"",e))}this.options.oneListGroup&&(r=this.buildObjectNode(r,i,"",e)),s+=r}else if(this.options.attributesGroupName&&i===this.options.attributesGroupName){const o=Object.keys(n[i]),r=o.length;for(let l=0;l<r;l++)t+=this.buildAttrPairStr(o[l],""+n[i][o[l]])}else s+=this.processTextOrObjNode(n[i],i,e);return{attrStr:t,val:s}};V.prototype.buildAttrPairStr=function(n,e){return e=this.options.attributeValueProcessor(n,""+e),e=this.replaceEntitiesValue(e),this.options.suppressBooleanAttributes&&e==="true"?" "+n:" "+n+'="'+e+'"'};function Ei(n,e,t){const s=this.j2x(n,t+1);return n[this.options.textNodeName]!==void 0&&Object.keys(n).length===1?this.buildTextValNode(n[this.options.textNodeName],e,s.attrStr,t):this.buildObjectNode(s.val,e,s.attrStr,t)}V.prototype.buildObjectNode=function(n,e,t,s){if(n==="")return e[0]==="?"?this.indentate(s)+"<"+e+t+"?"+this.tagEndChar:this.indentate(s)+"<"+e+t+this.closeTag(e)+this.tagEndChar;{let i="</"+e+this.tagEndChar,o="";return e[0]==="?"&&(o="?",i=""),t&&n.indexOf("<")===-1?this.indentate(s)+"<"+e+t+o+">"+n+i:this.options.commentPropName!==!1&&e===this.options.commentPropName&&o.length===0?this.indentate(s)+`<!--${n}-->`+this.newLine:this.indentate(s)+"<"+e+t+o+this.tagEndChar+n+this.indentate(s)+i}};V.prototype.closeTag=function(n){let e="";return this.options.unpairedTags.indexOf(n)!==-1?this.options.suppressUnpairedNode||(e="/"):this.options.suppressEmptyNode?e="/":e=`></${n}`,e};V.prototype.buildTextValNode=function(n,e,t,s){if(this.options.cdataPropName!==!1&&e===this.options.cdataPropName)return this.indentate(s)+`<![CDATA[${n}]]>`+this.newLine;if(this.options.commentPropName!==!1&&e===this.options.commentPropName)return this.indentate(s)+`<!--${n}-->`+this.newLine;if(e[0]==="?")return this.indentate(s)+"<"+e+t+"?"+this.tagEndChar;{let i=this.options.tagValueProcessor(e,n);return i=this.replaceEntitiesValue(i),i===""?this.indentate(s)+"<"+e+t+this.closeTag(e)+this.tagEndChar:this.indentate(s)+"<"+e+t+">"+i+"</"+e+this.tagEndChar}};V.prototype.replaceEntitiesValue=function(n){if(n&&n.length>0&&this.options.processEntities)for(let e=0;e<this.options.entities.length;e++){const t=this.options.entities[e];n=n.replace(t.regex,t.val)}return n};function mi(n){return this.options.indentBy.repeat(n)}function Ci(n){return n.startsWith(this.options.attributeNamePrefix)?n.substr(this.attrPrefixLen):!1}var Si=V;const Ii=Me,Ai=ci,Oi=Si;var Li={XMLParser:Ai,XMLValidator:Ii,XMLBuilder:Oi};const Ni=[{regex:/&(amp|#38|#x26);/g,val:"&"},{regex:/&(apos|#39|#x27);/g,val:"'"},{regex:/&#(xa|xA|10);/g,val:`
`},{regex:/&(gt|#62|#x3e|#x3E);/g,val:">"},{regex:/&(lt|#60|#x3c|#x3C);/g,val:"<"},{regex:/&(quot|#34|#x22);/g,val:'"'}];class vi{constructor(e){g(this,"x2jOptions",{attributeNamePrefix:"",removeNSPrefix:!0,ignoreAttributes:!1,parseAttributeValue:!0,processEntities:!1,attributeValueProcessor:(e,t)=>this.processAttribute(t)});g(this,"xmlParser",new Li.XMLParser(this.x2jOptions));this.options=e}parse(e){let t;try{t=this.xmlParser.parse(e)}catch{throw new Error("XML parsing failed. Invalid BPMN source.")}if(!t.definitions)throw new Error("XML parsing failed. Unable to retrieve 'definitions' from the BPMN source.");return t}processAttribute(e){var t;for(const s of Ni)e=e.replace(s.regex,s.val);return(t=this.options)!=null&&t.additionalXmlAttributeProcessor&&(e=this.options.additionalXmlAttributeProcessor(e)),e}}class j{}class _i{warning(e){const t=e.getMessage();console.warn(`[bv-parser] ${t.template}`,...t.arguments)}}class yi extends j{constructor(e,t){super(),this.groupBpmnElementId=e,this.categoryValueRef=t}getMessage(){return{arguments:[this.categoryValueRef,this.groupBpmnElementId],template:"Group json deserialization: unable to find category value ref %s for bpmn element %s"}}}class wi extends j{constructor(e){super(),this.bpmnElementId=e}getMessage(){return{arguments:[this.bpmnElementId],template:"Shape json deserialization: unable to find bpmn element with id %s"}}}class Ri extends j{constructor(e){super(),this.bpmnElementId=e}getMessage(){return{arguments:[this.bpmnElementId],template:"Edge json deserialization: unable to find bpmn element with id %s"}}}class bi extends j{constructor(e,t){super(),this.shapeOrEdgeId=e,this.labelStyleId=t}getMessage(){return{arguments:[this.labelStyleId,this.shapeOrEdgeId],template:"Unable to assign font from style %s to shape/edge %s"}}}class xi extends j{constructor(e,t){super(),this.laneId=e,this.flowNodeRef=t}getMessage(){return{arguments:[this.flowNodeRef,this.laneId],template:"Unable to assign lane %s as parent: flow node %s is not found"}}}class Fi extends j{constructor(e,t,s){super(),this.bpmnElementId=e,this.attachedToRef=t,this.attachedToKind=s}getMessage(){return{arguments:[this.bpmnElementId,this.attachedToRef,this.attachedToKind],template:"The boundary event %s must be attached to an activity, and not to %s of kind %s"}}}class Pi{constructor(){g(this,"poolsById",new Map);g(this,"poolsByProcessRef",new Map);g(this,"messageFlows",new Map);g(this,"flowNodes",new Map);g(this,"lanes",new Map);g(this,"sequenceFlows",new Map);g(this,"associationFlows",new Map);g(this,"eventDefinitionsOfDefinitions",new Map);g(this,"globalTasks",new Map);g(this,"categoryValues",new Map)}getFlows(){return[...this.messageFlows.values(),...this.sequenceFlows.values(),...this.associationFlows.values()]}findPoolById(e){return this.poolsById.get(e)}findPoolByProcessRef(e){return this.poolsByProcessRef.get(e)}registerPool(e,t){this.poolsById.set(e.id,e),t&&this.poolsByProcessRef.set(t,e)}findMessageFlow(e){return this.messageFlows.get(e)}registerMessageFlow(e){this.messageFlows.set(e.id,e)}findFlowNode(e){return this.flowNodes.get(e)}registerFlowNode(e){this.flowNodes.set(e.id,e)}findLane(e){return this.lanes.get(e)}registerLane(e){this.lanes.set(e.id,e)}findSequenceFlow(e){return this.sequenceFlows.get(e)}registerSequenceFlow(e){this.sequenceFlows.set(e.id,e)}findAssociationFlow(e){return this.associationFlows.get(e)}registerAssociationFlow(e){this.associationFlows.set(e.id,e)}findEventDefinitionOfDefinition(e){return this.eventDefinitionsOfDefinitions.get(e)}registerEventDefinitionsOfDefinition(e,t){this.eventDefinitionsOfDefinitions.set(e,t)}findGlobalTask(e){return this.globalTasks.get(e)}registerGlobalTask(e,t){this.globalTasks.set(e,t)}findCategoryValue(e){return this.categoryValues.get(e)}registerCategoryValue(e,t){this.categoryValues.set(e,{value:t})}}const yt=(n,e,t,s)=>{const i=n.findCategoryValue(t.categoryValueRef);if(i)return new k(t.id,i.value,d.GROUP,s);e.warning(new yi(t.id,t.categoryValueRef))};class ki{constructor(e,t){this.convertedElements=e,this.parsingMessageCollector=t}deserialize(e){C(e).forEach(t=>this.parseCollaboration(t))}parseCollaboration(e){this.buildParticipant(e.participant),this.buildMessageFlows(e.messageFlow),this.buildGroups(e.group)}buildParticipant(e){C(e).forEach(t=>this.convertedElements.registerPool(new k(t.id,t.name,d.POOL),t.processRef))}buildMessageFlows(e){C(e).forEach(t=>this.convertedElements.registerMessageFlow(new Et(t.id,t.name,t.sourceRef,t.targetRef)))}buildGroups(e){C(e).forEach(t=>{const s=yt(this.convertedElements,this.parsingMessageCollector,t);s&&this.convertedElements.registerFlowNode(s)})}}class Mi{constructor(e,t){g(this,"defaultSequenceFlowIds",[]);g(this,"elementsWithoutParentByProcessId",new Map);g(this,"callActivitiesCallingProcess",new Map);this.convertedElements=e,this.parsingMessageCollector=t}deserialize(e){C(e).forEach(t=>this.parseProcess(t)),C(e).forEach(t=>this.assignParentOfProcessElementsCalledByCallActivity(t.id)),this.assignIncomingAndOutgoingIdsFromFlows()}assignParentOfProcessElementsCalledByCallActivity(e){const t=this.callActivitiesCallingProcess.get(e);if(t){const s=this.convertedElements.findPoolByProcessRef(e);s&&(s.parentId=t.id),this.elementsWithoutParentByProcessId.get(e).forEach(i=>{i.parentId=t.id})}}assignIncomingAndOutgoingIdsFromFlows(){const e=(t,s,i)=>{const o=this.convertedElements.findFlowNode(t)??this.convertedElements.findLane(t)??this.convertedElements.findPoolById(t);o&&!o[s].includes(i)&&o[s].push(i)};this.convertedElements.getFlows().forEach(t=>{e(t.sourceRefId,"outgoingIds",t.id),e(t.targetRefId,"incomingIds",t.id)})}parseProcess(e){const t=e.id,s=this.convertedElements.findPoolByProcessRef(t);s&&!s.name&&this.convertedElements.registerPool(new k(s.id,e.name,d.POOL),t),this.buildProcessInnerElements(e,s==null?void 0:s.id)}buildProcessInnerElements(e,t){this.elementsWithoutParentByProcessId.set(e.id,[]),S.flowNodeKinds().filter(s=>s!=d.EVENT_BOUNDARY).forEach(s=>this.buildFlowNodeBpmnElements(e[s],s,t,e.id)),this.buildFlowNodeBpmnElements(e.boundaryEvent,d.EVENT_BOUNDARY,t,e.id),this.buildLaneBpmnElements(e[d.LANE],t,e.id),this.buildLaneSetBpmnElements(e.laneSet,t,e.id),this.buildSequenceFlows(e.sequenceFlow),this.buildAssociationFlows(e.association)}buildFlowNodeBpmnElements(e,t,s,i){C(e).forEach(o=>{let r;if(S.isEvent(t))r=this.buildShapeBpmnEvent(o,t,s);else if(S.isActivity(t))r=this.buildShapeBpmnActivity(o,t,s);else if(t==d.GATEWAY_EVENT_BASED){const c=o;r=new It(o.id,c.name,s,c.instantiate,se[c.eventGatewayType])}else if(t==d.GROUP)r=yt(this.convertedElements,this.parsingMessageCollector,o,s);else{const c=t===d.TEXT_ANNOTATION?o.text:o.name;r=new k(o.id,c,t,s,o.instantiate)}const l=o.default;S.isWithDefaultSequenceFlow(t)&&l&&this.defaultSequenceFlowIds.push(l),r&&(this.convertedElements.registerFlowNode(r),s||this.elementsWithoutParentByProcessId.get(i).push(r),r.incomingIds=C(o.incoming),r.outgoingIds=C(o.outgoing))})}buildShapeBpmnActivity(e,t,s){const i=Bi(e);return S.isSubProcess(t)?this.buildShapeBpmnSubProcess(e,s,i):S.isCallActivity(t)?this.buildShapeBpmnCallActivity(e,s,i):new Ie(e.id,e.name,t,s,e.instantiate,i)}buildShapeBpmnCallActivity(e,t,s){const i=this.convertedElements.findGlobalTask(e.calledElement);if(!i){const o=new ie(e.id,e.name,ne.CALLING_PROCESS,t,s);return this.callActivitiesCallingProcess.set(e.calledElement,o),o}return new ie(e.id,e.name,ne.CALLING_GLOBAL_TASK,t,s,i)}buildShapeBpmnEvent(e,t,s){const i=this.getEventDefinitions(e),o=i.map(r=>r.counter).reduce((r,l)=>r+l,0);if(o==0&&S.canHaveNoneEvent(t))return new oe(e.id,e.name,t,_.NONE,s);if(o==1){const r=i[0].kind;return S.isBoundaryEvent(t)?this.buildShapeBpmnBoundaryEvent(e,r):S.isStartEvent(t)?new Ct(e.id,e.name,r,s,e.isInterrupting):new oe(e.id,e.name,t,r,s)}}buildShapeBpmnBoundaryEvent(e,t){const s=this.convertedElements.findFlowNode(e.attachedToRef);if(S.isActivity(s==null?void 0:s.kind))return new St(e.id,e.name,t,e.attachedToRef,e.cancelActivity);this.parsingMessageCollector.warning(new Fi(e.id,e.attachedToRef,s==null?void 0:s.kind))}getEventDefinitions(e){const t=new Map;return lt.forEach(s=>{const i=e[s+"EventDefinition"],o=C(i,!0).length;t.set(s,o)}),C(e.eventDefinitionRef).forEach(s=>{const i=this.convertedElements.findEventDefinitionOfDefinition(s);t.set(i,t.get(i)+1)}),Array.from(t.keys()).map(s=>({kind:s,counter:t.get(s)})).filter(s=>s.counter>0)}buildShapeBpmnSubProcess(e,t,s){const i=e.triggeredByEvent?he.EVENT:he.EMBEDDED,o=new pe(e.id,e.name,i,t,s);return this.buildProcessInnerElements(e,e.id),o}buildLaneSetBpmnElements(e,t,s){C(e).forEach(i=>this.buildLaneBpmnElements(i.lane,t,s))}buildLaneBpmnElements(e,t,s){C(e).forEach(i=>{var r;const o=new k(i.id,i.name,d.LANE,t);this.convertedElements.registerLane(o),t||this.elementsWithoutParentByProcessId.get(s).push(o),this.assignParentOfLaneFlowNodes(i),(r=i.childLaneSet)!=null&&r.lane&&this.buildLaneBpmnElements(i.childLaneSet.lane,i.id,s)})}assignParentOfLaneFlowNodes(e){C(e.flowNodeRef).forEach(t=>{const s=this.convertedElements.findFlowNode(t),i=e.id;s?S.isBoundaryEvent(s.kind)||(s.parentId=i):this.parsingMessageCollector.warning(new xi(i,t))})}buildSequenceFlows(e){C(e).forEach(t=>{const s=this.getSequenceFlowKind(t);this.convertedElements.registerSequenceFlow(new pt(t.id,t.name,t.sourceRef,t.targetRef,s))})}buildAssociationFlows(e){C(e).forEach(t=>{const s=t.associationDirection;this.convertedElements.registerAssociationFlow(new mt(t.id,void 0,t.sourceRef,t.targetRef,s))})}getSequenceFlowKind(e){if(this.defaultSequenceFlowIds.includes(e.id))return P.DEFAULT;{const t=this.convertedElements.findFlowNode(e.sourceRef);if(t&&S.isWithDefaultSequenceFlow(t.kind)&&e.conditionExpression)return S.isActivity(t.kind)?P.CONDITIONAL_FROM_ACTIVITY:P.CONDITIONAL_FROM_GATEWAY}return P.NORMAL}}const Bi=n=>{const e=[],t=n.standardLoopCharacteristics,s=C(n.multiInstanceLoopCharacteristics,!0)[0];return t||t===""?e.push(v.LOOP):s&&e.push(s.isSequential?v.MULTI_INSTANCE_SEQUENTIAL:v.MULTI_INSTANCE_PARALLEL),e};class Gi{constructor(e,t,s,i){this.x=e,this.y=t,this.width=s,this.height=i}}class Vi{constructor(e,t,s,i,o=re.NONE){g(this,"extensions",{});this.id=e,this.bpmnElement=t,this.waypoints=s,this.label=i,this.messageVisibleKind=o}}class Yi{constructor(e,t){this.x=e,this.y=t}}class Ui{constructor(e,t){g(this,"extensions",{});this.font=e,this.bounds=t}}class Wi{constructor(e,t,s,i,o,r){this.name=e,this.size=t,this.isBold=s,this.isItalic=i,this.isUnderline=o,this.isStrikeThrough=r}}class z{constructor(e,t){g(this,"convertedFonts",new Map);this.convertedElements=e,this.parsingMessageCollector=t}deserialize(e){const t=[],s=[],i=[],o=[],r=C(e)[0];if(r){this.deserializeFonts(r.BPMNLabelStyle);const l=r.BPMNPlane,c=this.deserializeEdges(l.BPMNEdge),u=this.deserializeShapes(l.BPMNShape);t.push(...u.flowNodes),s.push(...u.lanes),i.push(...u.pools),o.push(...c)}return{flowNodes:t,lanes:s,pools:i,edges:o}}deserializeFonts(e){this.convertedFonts=new Map,C(e).forEach(t=>C(t.Font).forEach(s=>this.convertedFonts.set(t.id,new Wi(s.name,s.size,s.isBold,s.isItalic,s.isUnderline,s.isStrikeThrough))))}deserializeShapes(e){const t={flowNodes:[],lanes:[],pools:[]};return C(e).forEach(s=>{this.deserializeShapeAndStoreIfFound(s,t.flowNodes,i=>this.convertedElements.findFlowNode(i))||this.deserializeShapeAndStoreIfFound(s,t.lanes,i=>this.convertedElements.findLane(i))||this.deserializeShapeAndStoreIfFound(s,t.pools,i=>this.convertedElements.findPoolById(i))||this.parsingMessageCollector.warning(new wi(s.bpmnElement))}),t}deserializeShapeAndStoreIfFound(e,t,s){const i=this.deserializeShape(e,s);return i?(t.push(i),!0):!1}deserializeShape(e,t){const s=t(e.bpmnElement);if(s){const i=z.deserializeBounds(e);(s instanceof pe||s instanceof ie&&s.callActivityKind===ne.CALLING_PROCESS)&&!e.isExpanded&&s.markers.push(v.EXPAND);let o;S.isPoolOrLane(s.kind)&&(o=e.isHorizontal??!0);const r=e.BPMNLabel,l=this.deserializeLabel(r,e.id),c=new de(e.id,s,i,l,o);return z.setColorExtensionsOnShape(c,e),c}}static setColorExtensionsOnShape(e,t){"background-color"in t?e.extensions.fillColor=t["background-color"]:"fill"in t&&(e.extensions.fillColor=t.fill),"border-color"in t?e.extensions.strokeColor=t["border-color"]:"stroke"in t&&(e.extensions.strokeColor=t.stroke)}static deserializeBounds(e){const t=e.Bounds;if(t)return new Gi(t.x,t.y,t.width,t.height)}deserializeEdges(e){return C(e).map(t=>{const s=this.convertedElements.findSequenceFlow(t.bpmnElement)||this.convertedElements.findMessageFlow(t.bpmnElement)||this.convertedElements.findAssociationFlow(t.bpmnElement);if(!s){this.parsingMessageCollector.warning(new Ri(t.bpmnElement));return}const i=this.deserializeWaypoints(t.waypoint),o=this.deserializeLabel(t.BPMNLabel,t.id),r=t.messageVisibleKind?t.messageVisibleKind:re.NONE,l=new Vi(t.id,s,i,o,r);return z.setColorExtensionsOnEdge(l,t),l}).filter(Boolean)}static setColorExtensionsOnEdge(e,t){"border-color"in t?e.extensions.strokeColor=t["border-color"]:"stroke"in t&&(e.extensions.strokeColor=t.stroke)}deserializeWaypoints(e){return C(e).map(t=>new Yi(t.x,t.y))}deserializeLabel(e,t){if(e&&typeof e=="object"){const s=this.findFont(e.labelStyle,t),i=z.deserializeBounds(e),o=new Ui(s,i);if("color"in e)return o.extensions.color=e.color,o;if(s||i)return o}}findFont(e,t){let s;return e&&(s=this.convertedFonts.get(e),s||this.parsingMessageCollector.warning(new bi(t,e))),s}}class Hi{constructor(e){this.convertedElements=e}deserialize(e){lt.forEach(t=>{const s=e[t+"EventDefinition"];C(s,!0).forEach(i=>this.convertedElements.registerEventDefinitionsOfDefinition(i.id,t))})}}class Ki{constructor(e){this.convertedElements=e}deserialize(e){this.parseGlobalTasks(e.globalTask,d.GLOBAL_TASK),this.parseGlobalTasks(e.globalBusinessRuleTask,d.GLOBAL_TASK_BUSINESS_RULE),this.parseGlobalTasks(e.globalManualTask,d.GLOBAL_TASK_MANUAL),this.parseGlobalTasks(e.globalScriptTask,d.GLOBAL_TASK_SCRIPT),this.parseGlobalTasks(e.globalUserTask,d.GLOBAL_TASK_USER)}parseGlobalTasks(e,t){C(e).forEach(s=>this.convertedElements.registerGlobalTask(s.id,t))}}class zi{constructor(e){this.convertedElements=e}deserialize(e){C(e.category).forEach(t=>C(t.categoryValue).forEach(s=>this.convertedElements.registerCategoryValue(s.id,s.value)))}}class Di{constructor(e,t,s,i,o,r){this.categoryConverter=e,this.collaborationConverter=t,this.eventDefinitionConverter=s,this.globalTaskConverter=i,this.processConverter=o,this.diagramConverter=r}parse(e){const t=e.definitions;return this.categoryConverter.deserialize(t),this.collaborationConverter.deserialize(t.collaboration),this.eventDefinitionConverter.deserialize(t),this.globalTaskConverter.deserialize(t),this.processConverter.deserialize(t.process),this.diagramConverter.deserialize(t.BPMNDiagram)}}function Xi(n){const e=new Pi;return new Di(new zi(e),new ki(e,n),new Hi(e),new Ki(e),new Mi(e,n),new z(e,n))}class $i{constructor(e,t){this.jsonParser=e,this.xmlParser=t}parse(e){const t=this.xmlParser.parse(e);return this.jsonParser.parse(t)}}function Zi(n){return new $i(Xi(new _i),new vi(n))}class ji{constructor(){g(this,"classNamesByBpmnId",new Map);g(this,"clear",()=>{this.classNamesByBpmnId.clear()});g(this,"addClassNames",(e,t)=>this.updateClassNames(e,t,(s,i)=>s.add(i)));g(this,"removeClassNames",(e,t)=>this.updateClassNames(e,t,(s,i)=>s.delete(i)));g(this,"toggleClassNames",(e,t)=>(this.updateClassNames(e,t,(s,i)=>s.has(i)?s.delete(i):s.add(i)),t&&t.length>0))}getClassNames(e){return Array.from(this.classNamesByBpmnId.get(e)??[])}getBpmnIds(){return Array.from(this.classNamesByBpmnId.keys())}removeAllClassNames(e){const t=this.getOrInitializeClassNames(e),s=t.size;return t.clear(),t.size<s}updateClassNames(e,t,s){const i=this.getOrInitializeClassNames(e),o=i.size;return C(t).forEach(r=>s(i,r)),i.size!=o}getOrInitializeClassNames(e){let t=this.classNamesByBpmnId.get(e);return t==null&&(t=new Set,this.classNamesByBpmnId.set(e,t)),t}}class Ue{constructor(){g(this,"overlayPositions",new Map([["start",{horizontalAlign:"left",verticalAlign:"top"}],["middle",{horizontalAlign:"center",verticalAlign:"top"}],["end",{horizontalAlign:"right",verticalAlign:"top"}],["top-left",{horizontalAlign:"left",verticalAlign:"top"}],["top-right",{horizontalAlign:"right",verticalAlign:"top"}],["top-center",{horizontalAlign:"center",verticalAlign:"top"}],["bottom-left",{horizontalAlign:"left",verticalAlign:"bottom"}],["bottom-right",{horizontalAlign:"right",verticalAlign:"bottom"}],["bottom-center",{horizontalAlign:"center",verticalAlign:"bottom"}],["middle-left",{horizontalAlign:"left",verticalAlign:"middle"}],["middle-right",{horizontalAlign:"right",verticalAlign:"middle"}]]))}convert(e){const t=this.convertPosition(e),s=Ue.convertStyle(e);return{position:t,style:s}}convertPosition(e){return this.overlayPositions.get(e.position)}static convertStyle(e){const t={fill:{color:E.DEFAULT_OVERLAY_FILL_COLOR.valueOf(),opacity:E.DEFAULT_OVERLAY_FILL_OPACITY.valueOf()},stroke:{color:E.DEFAULT_OVERLAY_STROKE_COLOR.valueOf(),width:E.DEFAULT_OVERLAY_STROKE_WIDTH.valueOf()},font:{color:E.DEFAULT_OVERLAY_FONT_COLOR.valueOf(),size:E.DEFAULT_OVERLAY_FONT_SIZE.valueOf()}},s=e.style,i={...t};return s&&(this.convertFill(i,s.fill),this.convertStroke(i,s.stroke),this.convertFont(i,s.font)),i}static convertFill(e,t){t&&(e.fill.color=t.color??e.fill.color,e.fill.opacity=t.opacity??e.fill.opacity)}static convertStroke(e,t){t&&(e.stroke.color=t.color??e.stroke.color,e.stroke.width=t.width??e.stroke.width)}static convertFont(e,t){t&&(e.font.color=t.color??e.font.color,e.font.size=t.size??e.font.size)}}function qi(n){return new Qi(n,new Ue)}class Qi{constructor(e,t){this.graph=e,this.overlayConverter=t}updateAndRefreshCssClassesOfCell(e,t){this.updateAndRefreshCssClassesOfElement(e,t),this.updateAndRefreshCssClassesOfElement(At(e),t)}updateAndRefreshCssClassesOfElement(e,t){const s=this.graph.getModel().getCell(e);if(!s)return;let i=s.getStyle();i=w(i,m.EXTRA_CSS_CLASSES,t.join(",")),this.graph.model.setStyle(s,i)}addOverlays(e,t){const s=this.graph.getModel().getCell(e);s&&C(t).forEach(i=>{const o=new ht(i.label,this.overlayConverter.convert(i));this.graph.addCellOverlay(s,o)})}removeAllOverlays(e){const t=this.graph.getModel().getCell(e);t&&this.graph.removeCellOverlays(t)}updateStyle(e,t){if(!t)return;const s=C(e).map(i=>this.graph.getModel().getCell(i)).filter(Boolean);s.length!=0&&this.graph.batchUpdate(()=>{for(const i of s){let o=i.getStyle();o=w(o,a.mxConstants.STYLE_OPACITY,t.opacity,Ce),o=Ji(o,t.stroke),o=eo(o,t.font),no(t)&&(o=to(o,t.fill)),this.graph.model.setStyle(i,o)}})}}const Ee=n=>n=="default"?void 0:n,Ji=(n,e)=>(e&&(n=w(n,a.mxConstants.STYLE_STROKECOLOR,e.color,Ee),n=w(n,a.mxConstants.STYLE_STROKE_OPACITY,e.opacity,Ce),n=w(n,a.mxConstants.STYLE_STROKEWIDTH,e.width,vn)),n),w=(n,e,t,s=i=>i)=>t==null?n:a.mxUtils.setStyle(n,e,s(t)),ue=(n,e,t,s)=>s==null?n:a.mxUtils.setStyleFlag(n,e,t,s),eo=(n,e)=>(e&&(n=w(n,a.mxConstants.STYLE_FONTCOLOR,e.color,Ee),n=w(n,a.mxConstants.STYLE_FONTSIZE,e.size),n=w(n,a.mxConstants.STYLE_FONTFAMILY,e.family),n=ue(n,a.mxConstants.STYLE_FONTSTYLE,a.mxConstants.FONT_BOLD,e.isBold),n=ue(n,a.mxConstants.STYLE_FONTSTYLE,a.mxConstants.FONT_ITALIC,e.isItalic),n=ue(n,a.mxConstants.STYLE_FONTSTYLE,a.mxConstants.FONT_UNDERLINE,e.isUnderline),n=ue(n,a.mxConstants.STYLE_FONTSTYLE,a.mxConstants.FONT_STRIKETHROUGH,e.isStrikeThrough),n=w(n,a.mxConstants.STYLE_TEXT_OPACITY,e.opacity,Ce)),n),to=(n,e)=>(e.color&&(n=w(n,a.mxConstants.STYLE_FILLCOLOR,e.color,Ee),(n.includes(d.POOL)||n.includes(d.LANE))&&(n=w(n,a.mxConstants.STYLE_SWIMLANE_FILLCOLOR,e.color,Ee))),n=w(n,a.mxConstants.STYLE_FILL_OPACITY,e.opacity,Ce),n),no=n=>n&&typeof n=="object"&&"fill"in n;class so{element(e){return`svg > g > g > g[data-bpmn-id="${e}"]`}elementsOfKind(e){return`svg > g > g > g.${e}:not(.bpmn-label)`}}function io(n,e){return new oo(n,new ro(e.container,new so),new ji,qi(e))}class oo{constructor(e,t,s,i){this.bpmnModelRegistry=e,this.htmlElementRegistry=t,this.cssRegistry=s,this.graphCellUpdater=i,this.bpmnModelRegistry.registerOnLoadCallback(this.cssRegistry.clear)}getElementsByIds(e){return C(e).map(t=>this.bpmnModelRegistry.getBpmnSemantic(t)).filter(Boolean).map(t=>({bpmnSemantic:t,htmlElement:this.htmlElementRegistry.getBpmnHtmlElement(t.id)}))}getElementsByKinds(e){return C(e).map(t=>this.htmlElementRegistry.getBpmnHtmlElements(t).map(s=>({htmlElement:s,bpmnSemantic:this.bpmnModelRegistry.getBpmnSemantic(s.getAttribute("data-bpmn-id"))}))).reduce((t,s)=>(t.push(...s),t),[])}addCssClasses(e,t){this.updateCssClasses(e,t,this.cssRegistry.addClassNames)}removeCssClasses(e,t){this.updateCssClasses(e,t,this.cssRegistry.removeClassNames)}removeAllCssClasses(e){if(e)C(e).forEach(t=>{const s=this.cssRegistry.removeAllClassNames(t);this.updateCellIfChanged(s,t)});else{const t=this.cssRegistry.getBpmnIds();this.cssRegistry.clear(),t.forEach(s=>this.updateCellIfChanged(!0,s))}}toggleCssClasses(e,t){this.updateCssClasses(e,t,this.cssRegistry.toggleClassNames)}updateCssClasses(e,t,s){const i=C(t);C(e).forEach(o=>this.updateCellIfChanged(s(o,i),o))}updateCellIfChanged(e,t){if(e){const s=this.cssRegistry.getClassNames(t);this.graphCellUpdater.updateAndRefreshCssClassesOfCell(t,s)}}addOverlays(e,t){this.graphCellUpdater.addOverlays(e,t)}removeAllOverlays(e){this.graphCellUpdater.removeAllOverlays(e)}updateStyle(e,t){this.graphCellUpdater.updateStyle(e,t)}}class ro{constructor(e,t){this.container=e,this.querySelectors=t}getBpmnHtmlElement(e){return this.container.querySelector(this.querySelectors.element(e))}getBpmnHtmlElements(e){const t=this.querySelectors.elementsOfKind(we(e));return[...this.container.querySelectorAll(t)]}}class ao{filter(e,t){const s=[],i=[];if(C(t==null?void 0:t.pools).filter(T=>T&&Object.keys(T).length).forEach(T=>T.id?s.push(T.id):T.name&&i.push(T.name)),s.length==0&&i.length==0)return e;const{filteredPools:o,filteredPoolIds:r}=lo(e,s,i),l=[...s,...r],{filteredLanes:c,filteredLaneIds:u,filteredFlowNodes:h,filteredFlowNodeIds:f}=wt(e.lanes,e.flowNodes,l),p=uo(e.edges,[...l,...u,...f]);if(o.length==0&&c.length==0&&h.length==0&&p.length==0){let T=s.length>0?` for ids [${s}]`:"";const I=T?" and":"";throw T+=i.length>0?`${I} for names [${i}]`:"",new Error("No matching pools"+T)}return{lanes:c,flowNodes:h,pools:o,edges:p}}}function lo(n,e,t){const s=n.pools.filter(o=>e.includes(o.bpmnElement.id)||t.includes(o.bpmnElement.name)),i=s.map(o=>o.bpmnElement.id);return{filteredPools:s,filteredPoolIds:i}}function wt(n,e,t){const{filteredLanes:s,filteredLaneIds:i}=Rt(n,t),{filteredLanes:o,filteredLaneIds:r,filteredFlowNodes:l,filteredFlowNodeIds:c}=co(e,[...t,...i],n);return s.push(...o),i.push(...r),{filteredLanes:s,filteredLaneIds:i,filteredFlowNodes:l,filteredFlowNodeIds:c}}function Rt(n,e){const t=n.filter(i=>e.includes(i.bpmnElement.parentId)),s=t.map(i=>i.bpmnElement.id);if(t.length>0){const{filteredLanes:i,filteredLaneIds:o}=Rt(n,s);t.push(...i),s.push(...o)}return{filteredLanes:t,filteredLaneIds:s}}function co(n,e,t){const s=n.filter(u=>e.includes(u.bpmnElement.parentId));if(s.length===0)return{filteredLanes:[],filteredLaneIds:[],filteredFlowNodes:[],filteredFlowNodeIds:[]};const i=s.map(u=>u.bpmnElement.id),{filteredLanes:o,filteredLaneIds:r,filteredFlowNodes:l,filteredFlowNodeIds:c}=wt(t,n,i);return s.push(...l),i.push(...c),{filteredLanes:o,filteredLaneIds:r,filteredFlowNodes:s,filteredFlowNodeIds:i}}function uo(n,e){return n.filter(t=>e.includes(t.bpmnElement.sourceRefId)&&e.includes(t.bpmnElement.targetRefId))}class ho{constructor(){g(this,"searchableModel");g(this,"onLoadCallback")}load(e,t){var i;const s=new ao().filter(e,t);return this.searchableModel=new fo(s),(i=this.onLoadCallback)==null||i.call(this),go(s)}registerOnLoadCallback(e){this.onLoadCallback=e}getBpmnSemantic(e){var r;const t=(r=this.searchableModel)==null?void 0:r.elementById(e);if(!t)return;const s=t.bpmnElement,i=s instanceof k,o={id:e,name:s.name,isShape:i,kind:s.kind};return s instanceof Se?(o.sourceRefId=s.sourceRefId,o.targetRefId=s.targetRefId):(o.incomingIds=s.incomingIds,o.outgoingIds=s.outgoingIds),o}}function go(n){const e=n.flowNodes.filter(o=>{const r=o.bpmnElement;return S.isSubProcess(r.kind)&&r.markers.includes(v.EXPAND)}).map(o=>o.bpmnElement.id),t=[],s=[],i=[];return n.flowNodes.forEach(o=>{const r=o.bpmnElement.kind;S.isSubProcess(r)?t.push(o):S.isBoundaryEvent(r)?s.push(o):e.includes(o.bpmnElement.parentId)||i.push(o)}),{boundaryEvents:s,edges:n.edges,lanes:n.lanes,otherFlowNodes:i,pools:n.pools,subprocesses:t}}class fo{constructor(e){g(this,"elements",new Map);[].concat(e.pools,e.lanes,e.flowNodes,e.edges).forEach(t=>this.elements.set(t.bpmnElement.id,t))}elementById(e){return this.elements.get(e)}}function To(n){return n instanceof HTMLElement?n:document.getElementById(n)}class po{constructor(e){this.graph=e}fit(e){this.graph.customFit(e)}zoom(e){e=="in"?this.graph.zoomIn():this.graph.zoomOut()}}const Eo="0.35.0",mo=()=>({lib:Eo,dependencies:new Map([["mxGraph",a.mxClient.VERSION]])});class Co{constructor(e){g(this,"graph");g(this,"navigation");g(this,"bpmnElementsRegistry");g(this,"bpmnModelRegistry");g(this,"parserOptions");g(this,"rendererOptions");this.rendererOptions=e==null?void 0:e.renderer;const t=new as(To(e==null?void 0:e.container));this.graph=t.configure(e),this.navigation=new po(this.graph),this.bpmnModelRegistry=new ho,this.bpmnElementsRegistry=io(this.bpmnModelRegistry,this.graph),this.parserOptions=e==null?void 0:e.parser}load(e,t){const s=Zi(this.parserOptions).parse(e),i=this.bpmnModelRegistry.load(s,t==null?void 0:t.modelFilter);ds(this.graph,this.rendererOptions).render(i,t==null?void 0:t.fit)}getVersion(){return mo()}}function Uo(n){document.readyState==="complete"||document.readyState==="interactive"?setTimeout(n,1):document.addEventListener("DOMContentLoaded",n)}function A(n,...e){We("[DEMO]",n,...e)}function We(n,e,...t){console.info(n+" "+e,...t)}function R(n,...e){We("[DEMO STARTUP]",n,...e)}function bt(n,e){xt(n),window.alert(e??n)}function xt(n){console.error("[DEMO]",n)}function X(n,...e){We("[DEMO DOWNLOAD]",n,...e)}function So(n){return A(`Fetching BPMN content from url ${n}`),fetch(n).then(e=>{if(!e.ok)throw Error(`HTTP status ${e.status}`);return e.text()})}class Io{constructor(e,t,s,i){g(this,"document");g(this,"head");g(this,"body");this.window=e,this.outerContainerId=t,this.containerToFade=s,this.dropCallback=i,this.document=e.document,this.head=document.head,this.body=document.body,this.initializeDragAndDrop()}initializeDragAndDrop(){this.containerToFade.classList.add("faded-container"),this.addDomElements(this.containerToFade),this.addStyle();const e=document.getElementById(this.outerContainerId);this.preventDefaultsOnEvents(["dragover","drop"],this.window),this.preventDefaultsOnEvents(["dragover","dragleave","drop"],e),this.addEventsOnDropContainer(e,this.containerToFade),this.addEventsOnDocument(this.outerContainerId,this.containerToFade)}preventDefaults(e){e.preventDefault(),e.stopPropagation()}preventDefaultsOnEvents(e,t){e.forEach(s=>t.addEventListener(s,this.preventDefaults,!1))}addDomElements(e){const t=this.document.createElement("p");t.textContent="open BPMN diagram";const s=this.document.createElement("div");s.classList.add("drop-here-text"),s.appendChild(t);const i=this.document.createElement("div");i.id=this.outerContainerId,i.appendChild(s),e.parentNode.prepend(i)}addStyle(){const e=`
.faded-container {
    opacity: 1;
}
.faded-container.faded {
    opacity: 0.1;
}
#${this.outerContainerId} {
    display: none;
    overflow: hidden;
    position: absolute;
    top: 10px;
    right: 10px;
    bottom: 10px;
    left: 10px;
    font-weight: bold;
    text-align: center;
    color: #555;
    padding: 10px;
}
#${this.outerContainerId}.dragging {
    display: block;
}
#${this.outerContainerId} .drop-here-text {
    border: 2px solid transparent;
    width: 100%;
    height: 100%;
    overflow: hidden;
}
#${this.outerContainerId} .drop-here-text p {
    font-style: normal;
    font-family: monospace;
    font-size: 40px;
    color: rgba(1,1,1,.2);
}
#${this.outerContainerId}.dragging .drop-here-text {
    cursor: default;
    display: flex;
    justify-content: center;
    align-items: center;
    border: 2px dashed rgba(0,0,0,.2);
    border-radius: 7px;
}`,t=document.createElement("style");t.appendChild(document.createTextNode(e)),this.head.appendChild(t)}addEventsOnDropContainer(e,t){e.addEventListener("dragover",this.getAddClassCallback(t,!1),!1),e.addEventListener("mousedown",this.getRemoveClassCallback(t,!1),!1),e.addEventListener("drop",this.getDropCallbackForElement(t,!1,this.dropCallback),!1)}addEventsOnDocument(e,t){this.document.addEventListener("dragover",this.getAddClassCallback(t,!0,e),!1),this.document.addEventListener("dragleave",this.getRemoveClassCallback(t,!0,e),!1),this.document.addEventListener("drop",this.getDropCallbackForElement(t,!0,this.dropCallback,e),!1)}getAddClassCallback(e,t,s){return function(){t?this.querySelector("#"+s).classList.add("dragging"):this.classList.add("dragging"),e.classList.add("faded")}}getRemoveClassCallback(e,t,s){return function(){t?this.querySelector("#"+s).classList.remove("dragging"):this.classList.remove("dragging"),e.classList.remove("faded")}}getDropCallbackForElement(e,t,s,i){return function(o){try{const l=o.dataTransfer.files;s(l[0])}catch(r){bt(r)}finally{t?this.querySelector("#"+i).classList.remove("dragging"):this.classList.remove("dragging"),e.classList.remove("faded")}}}}class Ft{constructor(e){this.graph=e}exportSvg(){return this.doSvgExport(!0)}exportSvgForPng(){const e=a.mxClient.IS_FF;return this.doSvgExport(e)}doSvgExport(e){const t=this.computeSvg({scale:1,border:25,enableForeignObjectForLabel:e});return`<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
${a.mxUtils.getXml(t)}
`}computeSvg(e){const t=e.scale??1,s=e.border??0,i=e.crisp??!0,o=e.enableForeignObjectForLabel??!0,r=this.graph.getGraphBounds(),l=this.graph.view.scale,c=a.mxUtils.createXmlDocument(),u=c.createElementNS(a.mxConstants.NS_SVG,"svg"),h=t/l,f=Math.max(1,Math.ceil(r.width*h)+2*s),p=Math.max(1,Math.ceil(r.height*h)+2*s);u.setAttribute("version","1.1"),u.setAttribute("width",f+"px"),u.setAttribute("height",p+"px"),u.setAttribute("viewBox",(i?"-0.5 -0.5":"0 0")+" "+f+" "+p),c.appendChild(u);const T=c.createElementNS(a.mxConstants.NS_SVG,"g");u.appendChild(T);const I=this.createSvgCanvas(T);I.foEnabled=o,I.foOffset=i?-.5:0,I.textOffset=i?-.5:0,I.imageOffset=i?-.5:0,I.translate(Math.floor((s/t-r.x)/l),Math.floor((s/t-r.y)/l)),I.scale(h);const x=new a.mxImageExport;return x.includeOverlays=!0,x.drawState(this.graph.getView().getState(this.graph.model.root),I),c}createSvgCanvas(e){const t=new Ao(e);return t.pointerEvents=!0,t}}class Ao extends a.mxSvgCanvas2D{constructor(t){super(t);g(this,"htmlConverter",document.createElement("div"))}getAlternateText(t,s,i,o,r,l,c,u,h,f,p,T,I){return this.computeTruncatedText(l,o)}plainText(t,s,i,o,r,l,c,u,h,f,p,T){r=this.computeTruncatedText(r,i),super.plainText(t,s,i,o,r,l,c,u,h,f,p,T)}computeTruncatedText(t,s){if(t==null||this.state.fontSize<=0)return"";try{this.htmlConverter.innerHTML=t,t=a.mxUtils.extractTextWithWhitespace(this.htmlConverter.childNodes);const i=Math.ceil(2*s/this.state.fontSize),o=[];let r=0,l=0;for(;(i==0||r<i)&&l<t.length;){const c=t.charCodeAt(l);if(c==10||c==13){if(r>0)break}else o.push(t.charAt(l)),c<255&&r++;l++}o.length<t.length&&t.length-o.length>1&&(t=a.mxUtils.trim(o.join(""))+"...")}catch(i){console.warn("Error while computing txt label",i)}return t}}function Pt(n,e,t){const s=document.createElement("a");e.startsWith("data:image/svg+xml")&&(t=encodeURIComponent(t),e+=","),s.setAttribute("href",e+t),s.setAttribute("download",n),s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)}function Oo(n){X("Start SVG download"),Pt("diagram.svg","data:image/svg+xml",n),X("Download completed")}function Lo(n){X("Start PNG download");const e=new Blob([n],{type:"image/svg+xml;charset=utf-8"}),t=URL.createObjectURL(e),s=document.createElement("img");s.setAttribute("style","position: absolute; top: -9999px"),s.crossOrigin="anonymous",document.body.appendChild(s);const i=document.createElement("canvas"),o=i.getContext("2d");s.onload=function(){const r=new Image;i.width=s.naturalWidth,i.height=s.naturalHeight,r.crossOrigin="Anonymous",r.onload=function(){o.drawImage(r,0,0),URL.revokeObjectURL(t);const l=i.toDataURL("image/png");document.body.removeChild(s),Pt("diagram.png","",l),X("Download completed")},r.src=s.src},s.src=t}const No=new Map([["dark",{defaultFillColor:"#334352",defaultFontColor:"white",defaultStrokeColor:"#c0ddeb",endEventFillColor:"pink",endEventStrokeColor:"FireBrick",startEventFillColor:"DarkSeaGreen",startEventStrokeColor:"DarkGreen",taskAndCallActivityFillColor:"#5c8599",laneFillColor:"#2b3742",poolFillColor:"#232b33"}],["brown",{defaultFillColor:"#ede7e1",defaultFontColor:"#414666",defaultStrokeColor:"#414666",flowColor:"#666666",catchAndThrowEventStrokeColor:"#377f87",endEventFillColor:"pink",endEventStrokeColor:"FireBrick",startEventFillColor:"DarkSeaGreen",startEventStrokeColor:"DarkGreen",taskAndCallActivityFillColor:"#dadce8",laneFillColor:"#d4c3b2",poolFillColor:"#d1b9a1"}],["light-blue",{defaultFillColor:"#ffffff",defaultFontColor:"#002395",defaultStrokeColor:"#002395",endEventFillColor:"#f9dadc",endEventStrokeColor:"#e20613",startEventFillColor:"#ffffff",startEventStrokeColor:"#05d99e",taskAndCallActivityFillColor:"rgba(132,158,253,0.1)",textAnnotationFillColor:"rgba(237,237,245,0.5)",laneFillColor:"#edeef5",poolFillColor:"#dbefff"}]]);class vo extends Co{configureTheme(e){if(e=="default")return new ut(this.graph).configureStyles(),!0;const t=No.get(e);if(!t)return!1;const s=this.graph.getStylesheet();S.eventKinds().forEach(h=>{let f,p;switch(h){case"endEvent":f=t.endEventFillColor,p=t.endEventStrokeColor;break;case"startEvent":f=t.startEventFillColor,p=t.startEventStrokeColor;break;case"intermediateCatchEvent":case"intermediateThrowEvent":case"boundaryEvent":f=t.defaultFillColor,p=t.catchAndThrowEventStrokeColor??t.defaultStrokeColor;break;default:f=t.defaultFillColor,p=t.defaultStrokeColor;break}const T=s.styles[h];T.fillColor=f,T.strokeColor=p}),S.taskKinds().forEach(h=>{const f=s.styles[h];f.fillColor=t.taskAndCallActivityFillColor});const i=s.styles[d.CALL_ACTIVITY];i.fillColor=t.taskAndCallActivityFillColor;const o=s.styles[d.TEXT_ANNOTATION];o.fillColor=t.textAnnotationFillColor??E.TEXT_ANNOTATION_FILL_COLOR;const r=s.styles[d.POOL];r.fillColor=t.poolFillColor,r.swimlaneFillColor=t.defaultFillColor;const l=s.styles[d.LANE];l.fillColor=t.laneFillColor;const c=s.getDefaultVertexStyle();c.fontColor=t.defaultFontColor,c.fillColor=t.defaultFillColor,c.strokeColor=t.defaultStrokeColor;const u=s.getDefaultEdgeStyle();return u.fontColor=t.defaultFontColor,u.fillColor=t.defaultFillColor,u.strokeColor=t.flowColor??t.defaultStrokeColor,!0}configureSequenceFlowColor(e){R(`Use dedicated ${e} color for sequence flows`);const s=this.graph.getStylesheet().styles[b.SEQUENCE_FLOW];s[a.mxConstants.STYLE_STROKECOLOR]=e,s[a.mxConstants.STYLE_FILLCOLOR]=e,R("Sequence flows style updated")}}let O,B={},He,Ke,me,F;function Wo(n){A("Updating load options"),B.fit=n,A("Load options updated",B)}function Ho(){return{...B}}function Ko(){return me}function zo(n){A("Switching theme from %s to %s",me,n),O.configureTheme(n)?(O.graph.refresh(),A("Theme switch done"),me=n):A("Unknown theme, do nothing")}function kt(n,e=!0){A("Loading bpmn...");try{O.load(n,B),A("BPMN loaded with configuration",B),_o(Ke),document.dispatchEvent(new CustomEvent("diagramLoaded"))}catch(t){if(e)He(`Cannot load the BPMN diagram: ${t.message}`);else throw t}}function Do(n){A("Fitting..."),O.navigation.fit(n),A("Fit done with configuration",n)}function Xo(n){A(`Zooming '${n}'...`),O.navigation.zoom(n),A("Zoom done")}function $o(n){return O.bpmnElementsRegistry.getElementsByKinds(n)}function Zo(n,e){return O.bpmnElementsRegistry.addCssClasses(n,e)}function jo(n,e){return O.bpmnElementsRegistry.removeCssClasses(n,e)}function qo(n,e){return O.bpmnElementsRegistry.addOverlays(n,[e])}function Qo(n){return O.bpmnElementsRegistry.removeAllOverlays(n)}function _o(n){if(!Ke)return;A("Updating model, bpmnElement to collapse:",n);const e=O.graph.getModel(),t=e.getCell(n);if(!t)A("Element not found in the model, do nothing");else{e.beginUpdate();try{e.setCollapsed(t,!0)}finally{e.endUpdate()}A("Model updated")}}function Mt(n){const e=new FileReader;e.onload=()=>{kt(e.result)},e.readAsText(n)}function Jo(n){const e=n.target.files[0];Mt(e)}function yo(n){So(n).catch(e=>{throw new Error(`Unable to fetch ${n}. ${e}`)}).then(e=>(A("BPMN content fetched"),e)).then(e=>{kt(e,!1),A(`BPMN content loaded from url ${n}`)}).then(()=>{ko()}).catch(e=>{He(e.message)})}function er(n){bt(n)}function wo(n){xt(n)}function Ro(n,e){var o;const t=((o=n.loadOptions)==null?void 0:o.fit)||{},s=e.get("fitTypeOnLoad");s&&(t.type=s);const i=e.get("fitMargin");return i&&(t.margin=Number(i)),t}function bo(n){if(n.get("style.container.alternative.background.color")=="true"){const o="yellow";R("Use alternative color for the bpmn container background, color",o);const r=O.graph.container;r.style.backgroundColor=o,R("Bpmn container style updated")}const t=n.get("style.theme");R(`Configuring the '${t}' BPMN theme`),O.configureTheme(t)?(me=t,R(`'${t}' BPMN theme configured`)):R(`Unknown '${t}' BPMN theme, skipping configuration`),n.get("style.seqFlow.light.colors")=="true"&&O.configureSequenceFlowColor("#E9E9E9"),R('Configuring the "Update Style" API from query parameters'),Array.from(n.keys()).filter(o=>o.startsWith("style.api.")).length>0?(F={stroke:{},font:{},fill:{}},n.get("style.api.stroke.color")&&(F.stroke.color=n.get("style.api.stroke.color")),n.get("style.api.font.color")&&(F.font.color=n.get("style.api.font.color")),n.get("style.api.font.opacity")&&(F.font.opacity=Number(n.get("style.api.font.opacity"))),n.get("style.api.fill.color")&&(F.fill.color=n.get("style.api.fill.color")),n.get("style.api.fill.opacity")&&(F.fill.opacity=Number(n.get("style.api.fill.opacity"))),R('Prepared "Update Style" API object',F)):R('No query parameters, do not set the "Update Style" API object')}function xo(n){Ke=n.get("bpmn.element.id.collapsed")}function Fo(n){const e=n.get("bpmn.filter.pool.ids");if(!e)return;const t=e.split(",");return A("Configuring load options to only include pool id: ",t),{pools:t.map(s=>({id:s}))}}function tr(n){const e=R;e(`Initializing BpmnVisualization with container '${n.globalOptions.container}'...`);const t=new URLSearchParams(window.location.search),s=t.get("renderer.ignore.bpmn.colors");if(s){const o=s==="true";e('Ignore support for "BPMN in Color"?',o),!n.globalOptions.renderer&&(n.globalOptions.renderer={}),n.globalOptions.renderer.ignoreBpmnColors=o}O=new vo(n.globalOptions),e("Initialization completed"),new Io(window,"drop-container",O.graph.container,Mt),e("Drag&Drop support initialized"),He=n.statusKoNotifier??wo,e("Configuring Load Options"),B=n.loadOptions||{},B.fit=Ro(n,t),B.modelFilter=Fo(t),bo(t),xo(t),e("Checking if an 'url to fetch BPMN content' is provided as query parameter");const i=t.get("url");if(i){const o=decodeURIComponent(i);yo(o);return}e("No 'url to fetch BPMN content' provided")}function nr(){X("Trigger SVG Download"),Oo(new Ft(O.graph).exportSvg())}function sr(){X("Trigger PNG Download"),Lo(new Ft(O.graph).exportSvgForPng())}function ir(){const n=O.getVersion();return A("Version:",n),n}function Po(n,e){A("Applying style using the style API: %O",e),O.bpmnElementsRegistry.updateStyle(n,e),A("New style applied")}function ko(){if(F){const n=Mo();A("Number of elements whose style is to be updated",n.length),Po(n,F)}}function Mo(){A("Retrieving ids of all BPMN elements");const n=[...Object.values(d),...Object.values(b)],t=O.bpmnElementsRegistry.getElementsByKinds(n).map(s=>s.bpmnSemantic.id);return A("All BPMN elements ids retrieved:",t.length),t}export{te as F,S,Wt as Z,zo as a,ir as b,Ko as c,Uo as d,Qo as e,Do as f,Ho as g,Jo as h,Zo as i,nr as j,sr as k,A as l,Po as m,$o as n,qo as o,jo as r,tr as s,Wo as u,er as w,Xo as z};
